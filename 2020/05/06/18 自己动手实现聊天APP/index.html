

<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>自己动手实现聊天APP - 一只小安仔</title>
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="google" content="notranslate" />

  
  <meta name="keywords" content="一只小安仔,"> 
  
  <meta name="description" content="自己动手实现聊天APP成果


开始
时隔两年多，想再..."> 
  
  <meta name="author" content="junan"> 

  
    <link rel="icon" href="/images/icons/favicon-16x16.png" type="image/png" sizes="16x16">
  
  
    <link rel="icon" href="/images/icons/favicon-32x32.png" type="image/png" sizes="32x32">
  
  
    <link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png" sizes="180x180">
  
  
    <meta rel="mask-icon" href="/images/icons/stun-logo.svg" color="#333333">
  
  
    <meta rel="msapplication-TileImage" content="/images/icons/favicon-144x144.png">
    <meta rel="msapplication-TileColor" content="#000000">
  

  
<link rel="stylesheet" href="/css/style.css">


  
  
<link rel="stylesheet" href="//at.alicdn.com/t/font_1445822_58xq2j9v1id.css">

  

  
  
  
<link rel="stylesheet" href="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.css">

  

  
  
  
<link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.18.1/styles/xcode.min.css">

  

  
  
  
<link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css">

  

  <script>
    var CONFIG = window.CONFIG || {}
    CONFIG = {
      fancybox: true,
      pjax: false,
      lazyload: {
        enable: true,
        loadingImage: '/images/theme/loading.gif',
      },
      donate_alipay: '',
      donate_wechat: '',
      motto: {
        api: '',
        default: '夜半花落听雨声，不自欢喜不自愁。'
      },
      galleries: {
        enable: 'true'
      },
      fab: {
        enable: 'true',
        alwaysShow: 'false'
      }
    }
  </script>

  

  
<meta name="generator" content="Hexo 4.2.0"></head>
<body class="lock-screen">
  <div class="loading"></div>
  <nav class="menu">
  <div class="menu-close">
    <i class="iconfont iconplus"></i>
  </div>
  <ul class="menu-content">
    
    
    
    
    <li class="menu-item"><a href="/ "> 首页</a></li>
    
    
    
    
    <li class="menu-item"><a href="/archives "> 归档</a></li>
    
    
    
    
    <li class="menu-item"><a href="/tags "> 标签</a></li>
    
    
    
    
    <li class="menu-item"><a href="/categories "> 分类</a></li>
    
    
    
    
    <li class="menu-item"><a href="/about "> 关于</a></li>
    
  </ul>
  <div class="menu-copyright"><p>Copyright© 2019-2020 | <a target="_blank" href="http://junanaa.gitee.io/">一只小安仔</a> .AllRightsReserved</p></div>
</nav>
  <main id="main">
  <div class="container" id="container">
    <article class="article">
  <section class="head">
  <img   class="lazyload" data-original="http://pic.netbian.com/uploads/allimg/200219/224939-1582123779c853.jpg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  draggable="false">
  <div class="head-mask">
    <h1 class="head-title">自己动手实现聊天APP</h1>
    <div class="head-info">
      <span class="post-info-item"><i class="iconfont iconcalendar"></i>2020-05-06</span
        class="post-info-item">
      
      <span class="post-info-item"><i class="iconfont iconfont-size"></i>59968</span>
    </div>
  </div>
</section>
  <section class="main">
    <section class="content">
      <h1 id="自己动手实现聊天APP"><a href="#自己动手实现聊天APP" class="headerlink" title="自己动手实现聊天APP"></a>自己动手实现聊天APP</h1><h2 id="成果"><a href="#成果" class="headerlink" title="成果"></a>成果</h2><p><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429135658365.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="启动页"><br><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429135658176.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="登录页面"><br><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429135658255.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="联系人页面"><br><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429135658268.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="在这里插入图片描述"><br><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429135658248.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="发现页面"><br><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429135658315.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="我的页面"><br><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429143710159.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="尬友信息页面"><br><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429143710209.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="尬友聊天页面"><br><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429143710203.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="尬友聊天页面"></p>
<p><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429135658396.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="我的二维码页面"><br><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429135658558.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="扫一扫页面"><br><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429135658311.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="搜索页面"></p>
<p><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429135658377.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="关于页面"></p>
<h2 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h2><blockquote>
<p>时隔两年多，想再次看看 app 的开发。还记得两年前辛苦使用 andro studio 写 xml 的日子，五味杂陈。网上走了一圈，发现 dcloud 公司推出了 uni-app 和 5 + app 的方式开发 app ， 为了知道这些方式和  andro studio 开发 app 的区别。我开始了探寻。</p>
</blockquote>
<h3 id="uni-app-和-5-app"><a href="#uni-app-和-5-app" class="headerlink" title="uni-app 和 5 + app"></a>uni-app 和 5 + app</h3><blockquote>
<p>uni-app 最大的特点便是  <strong>编写一套代码，可发布到iOS、Android、H5、以及各种小程序（微信/支付宝/百度/头条/QQ/钉钉/淘宝）、快应用</strong> ，并且 <strong>基于vue</strong> 。听上去方便不少哦。</p>
</blockquote>
<blockquote>
<p>5 + app  是 <strong>HTML5 Plus移动App</strong>的意思。HTML5 plus（即HTML5 +）是W3C提供一套规范，属于工信部。扩展了 JavaScript 对象 plus，使得js可以调用摄像头、陀螺仪、文件系统等。HBuilder内置HTML5 + APP开发环境，可以在云端将代码打包为 apk 等文件。</p>
</blockquote>
<blockquote>
<p>经过测试发现 uni-app 编译过程稍微有点漫长，对于开发来说测试有点费时间。最终我选择 5 + app 的方式开发APP。</p>
</blockquote>
<h3 id="mui"><a href="#mui" class="headerlink" title="mui"></a>mui</h3><blockquote>
<p>打开 hbuilder ，新建项目可以发现有 mui 项目模板。</p>
</blockquote>
<p><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200428164427609.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70#pic_center" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="mui"></p>
<blockquote>
<p>mui 是 dcloud 公司推出的 5 + app 开发的一款 ui 框架 ，听说<strong>性能最接近原生APP</strong>。 官网是 【<a href="https://dev.dcloud.net.cn/mui/" target="_blank" rel="noopener">mui</a>】，官网提供了大量示例，可以参考（也可以粘贴复制哦）。但总的来说文档不是很丰富吧，有些功能我还是在百度解决。</p>
</blockquote>
<h2 id="尬聊APP"><a href="#尬聊APP" class="headerlink" title="尬聊APP"></a>尬聊APP</h2><h3 id="来源"><a href="#来源" class="headerlink" title="来源"></a>来源</h3><blockquote>
<p> 在学习了两天的 mui api后我想尝试写个 app 来锻炼下自己，也为了对比 5 + app 和 android studio 开发上的深层区别和感受，再加上之前对于 即时聊天 app 的 实现感兴趣，想摸索一番，于是取了这个名字便开始了开发。</p>
</blockquote>
<h3 id="技术选型"><a href="#技术选型" class="headerlink" title="技术选型"></a>技术选型</h3><blockquote>
<p>后端大致选择 springboot + netty + mybatisplus<br>前端大致选择 mui + vue<br>数据库依旧选择 mysql（当然后边可以换其他数据库）</p>
</blockquote>
<h3 id="项目注意点"><a href="#项目注意点" class="headerlink" title="项目注意点"></a>项目注意点</h3><blockquote>
<p> 前端代码需要注意几个问题 :<br> 1 mui 配合 vue 一起玩的时候 @click 会不起作用，只能用  mui 去绑定 tap 事件后调用 this.click() 方法，因为 mui 禁用了 click 事件 ，点击会触发 tap 事件。当然本页面暂未使用到 vue ， 其他页面注意。解决代码如下：<br> <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js">mui(<span class="hljs-built_in">document</span>.body).on(<span class="hljs-string">'tap'</span>, <span class="hljs-string">'#btn_clcik'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>&#123;<br><span class="hljs-keyword">this</span>.click()<br>&#125;)<br></code></pre></td></tr></table></figure><br> 2 mui 配合 vue 一起玩的时候 v-model 双向绑定不起作用。暂时我使用 document 去获取值。比如获取输入框内容时：<br> <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'galiao_userId'</span>).value<br></code></pre></td></tr></table></figure><br> 3 如果自定义的 js 文件用到 mui 、vue、axios 中的对象或方法时，尽量后引入。比如：<br> <figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/vue/2.6.11/vue.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/axios/0.19.2/axios.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js/mui.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js/app.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><br> 4 尽量使用 v-text 代替 {{ }} 避免插值闪烁。</p>
</blockquote>
<h3 id="后端项目"><a href="#后端项目" class="headerlink" title="后端项目"></a>后端项目</h3><h5 id="构建"><a href="#构建" class="headerlink" title="构建"></a>构建</h5><blockquote>
<p>新建maven工程，pom.xml：</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span> <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.2.6.RELEASE<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>/&gt;</span> <span class="hljs-comment">&lt;!-- lookup parent from repository --&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.junan<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>galiao<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>galiao<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">description</span>&gt;</span>尬聊 v1 服务端<span class="hljs-tag">&lt;/<span class="hljs-name">description</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">java.version</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">java.version</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">fastjson.version</span>&gt;</span>1.2.58<span class="hljs-tag">&lt;/<span class="hljs-name">fastjson.version</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">mybatis-plus.version</span>&gt;</span>3.2.0<span class="hljs-tag">&lt;/<span class="hljs-name">mybatis-plus.version</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">mybatisplus-generation.version</span>&gt;</span>3.2.0<span class="hljs-tag">&lt;/<span class="hljs-name">mybatisplus-generation.version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.1.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>mysql<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mysql-connector-java<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>runtime<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.auth0<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>java-jwt<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.1.0<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>io.netty<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>netty-all<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.alibaba<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>fastjson<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;fastjson.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">optional</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">optional</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.baomidou<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;mybatis-plus.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.baomidou<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>mybatis-plus-generator<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>$&#123;mybatisplus-generation.version&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-freemarker<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">exclusions</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">exclusion</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.junit.vintage<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>junit-vintage-engine<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">exclusion</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">exclusions</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br></code></pre></td></tr></table></figure>
<h3 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h3><p><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429152005282.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70#pic_center" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="项目结构"></p>
<h3 id="核心"><a href="#核心" class="headerlink" title="核心"></a>核心</h3><blockquote>
<p> 核心功能便是 netty 提供的服务了，在 netty 包下三个类：</p>
</blockquote>
<p><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429152154178.png#pic_center" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="netty包"></p>
<blockquote>
<p> GaLiaoServer 表示 Netty  服务的启动类。<br> GaLiaoServerInitializer  表示  Netty 服务的初始化类。<br> GaLiaoHandler  表示Netty 服务的处理器类。（这里面包含消息的接受和发送，它就是核心）</p>
</blockquote>
<blockquote>
<p> 至于代码方面大家感兴趣可以去【<a href="https://gitee.com/junanaa/galiao-java" target="_blank" rel="noopener">尬聊开源后端项目</a>】</p>
</blockquote>
<h3 id="项目启动页（index-html）"><a href="#项目启动页（index-html）" class="headerlink" title="项目启动页（index.html）"></a>项目启动页（index.html）</h3><blockquote>
<p>前端代码：</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>首页<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"css/mui.min.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> /&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><br>	<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js/mui.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span><br>		<br>		mui.init();<br><br><span class="actionscript">		mui.plusReady(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="actionscript">			<span class="hljs-comment">// 弹到登录页面</span></span><br>			mui.openWindow(&#123;<br><span class="actionscript">				url: <span class="hljs-string">'login.html'</span>,</span><br><span class="actionscript">				id: <span class="hljs-string">'login'</span></span><br>			&#125;);<br>		&#125;)<br><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>这个页面暂时只是负责打开了登录页面，后期可以做成判断是否登录或自动登录，根据情况跳转到不同页面。</p>
<h3 id="登录（login-html）"><a href="#登录（login-html）" class="headerlink" title="登录（login.html）"></a>登录（login.html）</h3><h4 id="架构图"><a href="#架构图" class="headerlink" title="架构图"></a>架构图</h4></blockquote>
<p><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200428214317579.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70#pic_center" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="登录架构"></p>
<blockquote>
<p>主要还是使用 mvc ，这里暂时不用 netty 。登录成功返回 token，客户端保存 token ，携带 token 访问服务端资源，包含后期使用 netty 发送消息也需要携带 token 。</p>
</blockquote>
<blockquote>
<p>前端登录页面代码：</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!doctype <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>登录<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"css/mui.min.css"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"css/app.css"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><br>			body &#123;<br><span class="css">			<span class="hljs-selector-tag">background-color</span>: <span class="hljs-selector-id">#FFFFFF</span>;</span><br>		&#125;<br><br><span class="css">		<span class="hljs-selector-class">.title</span> &#123;</span><br>			margin: 0;<br><span class="css">			<span class="hljs-selector-tag">background-color</span>: <span class="hljs-selector-id">#FFFFFF</span>;</span><br>		&#125;<br><span class="css">		<span class="hljs-selector-class">.logo</span> &#123;</span><br>			width: 100px;<br>			height: 100px;<br>			border-radius: 10px;<br>		&#125;<br><span class="css">		<span class="hljs-selector-class">.form</span> &#123;</span><br>			margin-left: 10%;<br>			margin-right: 10%;<br><span class="css">			<span class="hljs-selector-tag">background-color</span>: <span class="hljs-selector-id">#FFFFFF</span>;</span><br>		&#125;<br><span class="css">		<span class="hljs-selector-class">.form</span> <span class="hljs-selector-class">.galiao-user-id</span>, <span class="hljs-selector-class">.form</span> <span class="hljs-selector-class">.galiao-user-password</span> &#123;</span><br>			margin-bottom: 30px;<br>			border: none;<br>			border-radius: 50px;<br><span class="css">			<span class="hljs-selector-tag">background-color</span>: <span class="hljs-selector-id">#F3F3F3</span>;</span><br>		&#125;<br><span class="css">		<span class="hljs-selector-class">.btn-ok</span> &#123;</span><br>			width: 70px;<br>			height: 70px;<br>			border-radius: 35px;<br>		&#125;<br><span class="css">		<span class="hljs-selector-class">.btn-img</span> &#123;</span><br>			width: 40px;<br>			height: 40px;<br>			padding-top: 5px;<br>		&#125;<br>	<span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><br>		<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-content"</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"margin-top: 40%; text-align: center; background-color: #FFFFFF;"</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"title"</span>&gt;</span>尬聊 v1.0<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"background-color: #FFFFFF;margin: 30px 0;"</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"logo"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"img/logo.png"</span> /&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>				<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form"</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-input-clear galiao-user-id"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"1000"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"galiao_userId"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"尬聊号"</span>&gt;</span><br>					<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-input-row"</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-input-password galiao-user-password"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"123456"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"galiao_password"</span></span><br><span class="hljs-tag">						 <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"密码"</span>&gt;</span><br>					<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn_clcik"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-btn mui-btn-success btn-ok"</span>&gt;</span><br>							<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn-img"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"img/ok.png"</span> /&gt;</span><br>						<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>					<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js/config.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/vue/2.6.11/vue.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/axios/0.19.2/axios.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js/mui.min.js"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js/app.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><br>			mui.init()<br><br><span class="actionscript">			mui.plusReady(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="actionscript">				<span class="hljs-comment">// 关闭 index 页面</span></span><br>				plus.webview.currentWebview().opener().close()<br>			&#125;)<br><br><span class="actionscript">			<span class="hljs-comment">// 登录操作</span></span><br><span class="javascript">			mui(<span class="hljs-built_in">document</span>.body).on(<span class="hljs-string">'tap'</span>, <span class="hljs-string">'#btn_clcik'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="actionscript">				<span class="hljs-comment">// 关闭软键盘（否则老弹出来）</span></span><br><span class="javascript">				<span class="hljs-built_in">document</span>.activeElement.blur();</span><br><br><span class="javascript">				<span class="hljs-keyword">let</span> userId = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'galiao_userId'</span>).value</span><br><span class="javascript">				<span class="hljs-keyword">let</span> userPwd = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'galiao_password'</span>).value</span><br><br><span class="actionscript">				<span class="hljs-comment">// 验证用户名密码是否输入</span></span><br><span class="actionscript">				<span class="hljs-keyword">if</span> (userId === <span class="hljs-string">''</span>) &#123;</span><br><span class="actionscript">					mui.alert(<span class="hljs-string">"请输入尬聊号！"</span>)</span><br>				&#125;<br><br><span class="actionscript">				<span class="hljs-keyword">if</span> (userId === <span class="hljs-string">''</span>) <span class="hljs-keyword">return</span> <span class="hljs-comment">// 直接在上面if里面return alert就会没反应，一切为了用户体验</span></span><br><br><span class="actionscript">				<span class="hljs-keyword">if</span> (userPwd === <span class="hljs-string">''</span>) &#123;</span><br><span class="actionscript">					mui.alert(<span class="hljs-string">"请输入密码！"</span>)</span><br>				&#125;<br><br><span class="actionscript">				<span class="hljs-keyword">if</span> (userPwd === <span class="hljs-string">''</span>) <span class="hljs-keyword">return</span> <span class="hljs-comment">// 直接在上面if里面return alert就会没反应 一切为了用户体验</span></span><br><br><span class="actionscript">				<span class="hljs-comment">// 显示加载中动画</span></span><br><span class="actionscript">				mui.showLoading(<span class="hljs-string">"正在登录...."</span>,<span class="hljs-string">"div"</span>)</span><br><span class="actionscript">				<span class="hljs-comment">// 发起登陆请求</span></span><br>				axios(&#123;<br><span class="actionscript">						url: config.app.baseUrl + <span class="hljs-string">'/user/login'</span>,</span><br><span class="actionscript">						method: <span class="hljs-string">'post'</span>,</span><br>						headers: &#123;<br><span class="actionscript">							<span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span></span><br>						&#125;,<br>						data: &#123;<br>							userId: userId,<br>							userPwd: userPwd<br>						&#125;<br>					&#125;)<br><span class="actionscript">					.then(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(res)</span> </span>&#123;</span><br><span class="actionscript">						<span class="hljs-keyword">var</span> data = res.data</span><br>						if (data.code != 1) &#123;<br>							mui.alert(data.data)<br><span class="actionscript">							<span class="hljs-keyword">return</span></span><br>						&#125;<br><span class="actionscript">						<span class="hljs-comment">// 登陆成功</span></span><br><span class="actionscript">						<span class="hljs-comment">// 1 记录 登录信息  （user里面包含token）</span></span><br>						data.data.token = data.token<br><span class="javascript">						<span class="hljs-keyword">let</span> user = <span class="hljs-built_in">JSON</span>.stringify(data.data)</span><br><span class="actionscript">						plus.storage.setItem(<span class="hljs-string">"user"</span>, user)</span><br><span class="actionscript">						<span class="hljs-comment">// 2 跳转页面</span></span><br>						mui.openWindow(&#123;<br><span class="actionscript">							url: <span class="hljs-string">'main.html'</span>,</span><br><span class="actionscript">							id: <span class="hljs-string">'main'</span></span><br>						&#125;);<br>						<br><span class="actionscript">						<span class="hljs-comment">// 关闭加载</span></span><br>						mui.hideLoading()<br>					&#125;)<br><span class="actionscript">					.catch(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(error)</span> </span>&#123;</span><br><span class="actionscript">						<span class="hljs-comment">// 关闭加载</span></span><br>						mui.hideLoading()<br>						<br><span class="actionscript">						mui.alert(<span class="hljs-string">"网络故障！"</span>)</span><br>					&#125;);<br>			&#125;)<br><br><span class="actionscript">			<span class="hljs-comment">// 关闭其他页面</span></span><br><span class="javascript">			<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">'clearOtherHtml'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>&#123;</span><br><span class="actionscript">				<span class="hljs-comment">// 获取当前webview窗口对象</span></span><br><span class="actionscript">				<span class="hljs-keyword">var</span> curr = plus.webview.currentWebview()</span><br><span class="actionscript">				<span class="hljs-comment">//获取所有已经打开的webview窗口</span></span><br><span class="actionscript">				<span class="hljs-keyword">var</span> wvs = plus.webview.all()</span><br><span class="actionscript">				<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, len = wvs.length; i &lt; len; i++) &#123;</span><br><span class="actionscript">					<span class="hljs-comment">//关闭除当前页面外的其他页面</span></span><br>					if (wvs[i].id == curr.id)<br><span class="actionscript">						<span class="hljs-comment">//遇到当前页跳过</span></span><br><span class="actionscript">						<span class="hljs-keyword">continue</span></span><br>						<br><span class="actionscript">					<span class="hljs-comment">// 先hide，避免闪一下</span></span><br>					wvs[i].hide()<br><span class="actionscript">					<span class="hljs-comment">//非当前页执行关闭</span></span><br>					wvs[i].close()<br>				&#125;<br>			&#125;);<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p> 登录页面效果：</p>
</blockquote>
<p><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200428215819658.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70#pic_center" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="登录页面"></p>
<blockquote>
<p>后端主要代码：</p>
</blockquote>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Message <span class="hljs-title">login</span><span class="hljs-params">(User user)</span> </span>&#123;<br>    User byId = getById(user.getUserId());<br>    <span class="hljs-keyword">if</span> (byId == <span class="hljs-keyword">null</span>) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Message()<br>                .code(MessageCode.FAIL.value())<br>                .data(<span class="hljs-string">"用户不存在！"</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">if</span> (!encoder.matches(user.getUserPwd(), byId.getUserPwd())) &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Message()<br>                .code(MessageCode.FAIL.value())<br>                .data(<span class="hljs-string">"用户名或密码错误！"</span>);<br>    &#125;<br><br>    <span class="hljs-comment">// 密码正确，产生token并返回</span><br>    user.setUserPwd(<span class="hljs-keyword">null</span>);     <span class="hljs-comment">// 清理掉密码</span><br>    byId.setUserPwd(<span class="hljs-keyword">null</span>);     <span class="hljs-comment">// 清理掉密码</span><br>    String token = JwtTokenUtil.createToken(user);<br><br>    <span class="hljs-comment">// redis 存储登录的用户的信息 (存储一天)</span><br>    redisUtil.set(token, FastJsonUtil.toJSONString(byId), <span class="hljs-number">24</span> * <span class="hljs-number">60</span> * <span class="hljs-number">60</span>);<br><br>    <span class="hljs-comment">// 获取好友</span><br>    String[] friendIds = byId.getUserFriends().split(<span class="hljs-string">","</span>);<br>    QueryWrapper&lt;User&gt; wrapper = <span class="hljs-keyword">new</span> QueryWrapper&lt;&gt;();<br>    wrapper.in(<span class="hljs-string">"user_id"</span>, friendIds);<br>    wrapper.select(<span class="hljs-string">"user_id"</span>, <span class="hljs-string">"user_avatar"</span>, <span class="hljs-string">"user_nickname"</span>);<br>    List&lt;User&gt; users = userMapper.selectList(wrapper);<br>    byId.setFriends(users);<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Message().code(MessageCode.OK.value()).data(byId).token(token);<br>&#125;<br></code></pre></td></tr></table></figure>
<blockquote>
<p>后端主要用到 spring security 的 BCryptPasswordEncoder 对密码加密和解密，用的 sha256 算法，因此不可逆的，保证密码的安全性。登录成功后会将用户的基本信息（除了密码）放入redis ，key 为用户的token， 暂时默认存一天也是 token 的过期时间。然后把用户信息返回客户端，客户端保存在 localstorage 供页面之间共享。</p>
</blockquote>
<h3 id="主页面（main-html）"><a href="#主页面（main-html）" class="headerlink" title="主页面（main.html）"></a>主页面（main.html）</h3><blockquote>
<p> 主页面主要是 main.html 页面，这个页面有一个底部导航栏来控制显示其他几个页面。<br> 前端代码如下：</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!doctype <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><br>	<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>主页面<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"css/mui.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><br><span class="css">			<span class="hljs-selector-class">.mui-bar-tab</span> <span class="hljs-selector-class">.mui-tab-item</span><span class="hljs-selector-class">.mui-active</span> &#123;</span><br><span class="css">				<span class="hljs-selector-tag">color</span>: <span class="hljs-selector-id">#4DB361</span>; <span class="hljs-comment">/* 这里放你底部导航栏颜色 */</span></span><br>			&#125;<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br>	<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><br>		<span class="hljs-comment">&lt;!-- 底部导航栏 --&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">nav</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-bar mui-bar-tab"</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-tab-item mui-active"</span> <span class="hljs-attr">tabindex</span>=<span class="hljs-string">"0"</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-icon mui-icon-chat"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-tab-label"</span>&gt;</span>消息<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-tab-item"</span> <span class="hljs-attr">tabindex</span>=<span class="hljs-string">"1"</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-icon mui-icon-list"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-tab-label"</span>&gt;</span>联系人<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-tab-item"</span> <span class="hljs-attr">tabindex</span>=<span class="hljs-string">"2"</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-icon mui-icon-paperplane"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-tab-label"</span>&gt;</span>发现<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-tab-item"</span> <span class="hljs-attr">tabindex</span>=<span class="hljs-string">"3"</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-icon mui-icon-home"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-tab-label"</span>&gt;</span>我的<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span><br>		<br>		<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span><br>			<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js/mui.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/vue/2.6.11/vue.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><br>			mui.init()<br>			<br><span class="actionscript">			<span class="hljs-keyword">var</span> vue = <span class="hljs-keyword">new</span> Vue(&#123;</span><br><span class="actionscript">				el: <span class="hljs-string">'#app'</span>,</span><br>				created() &#123;<br><span class="actionscript">					mui.plusReady(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>&#123;</span><br>						if(plus.webview.currentWebview().opener()) &#123;<br><span class="actionscript">							<span class="hljs-keyword">var</span> curr = plus.webview.currentWebview()</span><br><span class="actionscript">							<span class="hljs-keyword">var</span> wvs = plus.webview.all()</span><br><span class="actionscript">							<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, len = wvs.length; i &lt; len; i++) &#123;</span><br><span class="actionscript">								<span class="hljs-keyword">if</span> (wvs[i].id == <span class="hljs-string">'login'</span> || wvs[i].id == <span class="hljs-string">'HBuilder'</span>) &#123;</span><br><span class="actionscript">									<span class="hljs-comment">// 先hide再关闭 ，避免闪一下</span></span><br>									wvs[i].hide()<br>									wvs[i].close()<br>								&#125;<br>							&#125;<br>						&#125;<br>						init();<br>					&#125;);<br>				&#125;<br>			&#125;)<br><br>			/**<br>			 * main页面初始化<br>			 */<br><span class="actionscript">			<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">init</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="actionscript">				<span class="hljs-keyword">var</span> sixinArray = [&#123;</span><br><span class="actionscript">						pageUrl: <span class="hljs-string">'message.html'</span>,</span><br><span class="actionscript">						pageId: <span class="hljs-string">'message'</span></span><br>					&#125;,<br>					&#123;<br><span class="actionscript">						pageUrl: <span class="hljs-string">'friends.html'</span>,</span><br><span class="actionscript">						pageId: <span class="hljs-string">'friends'</span></span><br>					&#125;,<br>					&#123;<br><span class="actionscript">						pageUrl: <span class="hljs-string">'found.html'</span>,</span><br><span class="actionscript">						pageId: <span class="hljs-string">'found'</span></span><br>					&#125;,<br>					&#123;<br><span class="actionscript">						pageUrl: <span class="hljs-string">'mine.html'</span>,</span><br><span class="actionscript">						pageId: <span class="hljs-string">'mine'</span></span><br>					&#125;<br>				]<br><br><span class="actionscript">				<span class="hljs-keyword">var</span> sixinStyle = &#123;</span><br><span class="actionscript">					top: <span class="hljs-string">'0px'</span>,</span><br><span class="actionscript">					bottom: <span class="hljs-string">'51px'</span></span><br>				&#125;<br><span class="actionscript">				<span class="hljs-comment">//获取当前的webview对象</span></span><br><span class="actionscript">				<span class="hljs-keyword">var</span> indexWebview = plus.webview.currentWebview();</span><br><br><span class="actionscript">				<span class="hljs-comment">//向当前的主页webview追加子页的4张webview对象</span></span><br><span class="actionscript">				<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; sixinArray.length; i++) &#123;</span><br><br><span class="actionscript">					<span class="hljs-keyword">var</span> sixinPage = plus.webview.create(sixinArray[i].pageUrl,</span><br>						sixinArray[i].pageId, sixinStyle);<br><span class="actionscript">					<span class="hljs-comment">//创建完后不需要马上显示,只有点击的时候才显示,所以隐藏webview窗口</span></span><br>					sixinPage.hide();<br><br><span class="actionscript">					<span class="hljs-comment">//追加每一个子页面到当前主页面</span></span><br>					indexWebview.append(sixinPage);<br>				&#125;<br><span class="actionscript">				<span class="hljs-comment">//设置默认显示页面</span></span><br>				plus.webview.show(sixinArray[0].pageId);<br><br><span class="actionscript">				<span class="hljs-comment">//批量绑定tap(点击)事件,展示不同的页面</span></span><br><span class="actionscript">				<span class="hljs-comment">//通过mui选择器选择唯一的class ,on是表示触发的事件,tap表示手指触摸点击事件类型</span></span><br><span class="actionscript">				<span class="hljs-comment">//第二个参数表示link的对象,也可以用共同的a标签代替</span></span><br><span class="actionscript">				mui(<span class="hljs-string">".mui-bar-tab"</span>).on(<span class="hljs-string">"tap"</span>, <span class="hljs-string">".mui-tab-item"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="actionscript">					<span class="hljs-comment">//或者使用a标签选择器  mui(".mui-bar-tab").on("tap", "a", function() &#123; </span></span><br><span class="actionscript">					<span class="hljs-comment">//在要点击的标签处添加事件名 并且获取到相应的对象</span></span><br><span class="actionscript">					<span class="hljs-keyword">var</span> tabindex = <span class="hljs-keyword">this</span>.getAttribute(<span class="hljs-string">"tabindex"</span>);</span><br><span class="actionscript">					<span class="hljs-comment">//显示tap点击的页面,第一个id,第二个动画效果,第三个延迟时间</span></span><br><span class="actionscript">					plus.webview.show(sixinArray[tabindex].pageId, <span class="hljs-string">"none"</span>, <span class="hljs-number">400</span>);</span><br><br><span class="actionscript">					<span class="hljs-comment">//隐藏不需要的页面</span></span><br><span class="actionscript">					<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; sixinArray.length; i++) &#123;</span><br>						if (i != tabindex) &#123;<br><span class="actionscript">							plus.webview.hide(sixinArray[i].pageId, <span class="hljs-string">"none"</span>, <span class="hljs-number">400</span>);</span><br>						&#125;<br>					&#125;<br>				&#125;);<br><br>			&#125;<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>该页面效果如下：</p>
</blockquote>
<p><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200428222450830.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70#pic_center" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="主页面"></p>
<blockquote>
<p> <strong>该页面难点在于底部导航栏每个 a 标签控制每个页面显示与隐藏，而官网只提供了基于a 标签 href 的代码块的显示与隐藏，这种方式需要将其他页面以 div 的方式写在 main 页面，会导致 main 页面代码过于冗杂。本次使用的切换 html 的方式核心代码在于 init 方法，通过 a 标签上的  tabindex 的值来显示不同页面。</strong></p>
</blockquote>
<h3 id="消息页面（message-html）"><a href="#消息页面（message-html）" class="headerlink" title="消息页面（message.html）"></a>消息页面（message.html）</h3><blockquote>
<p>前端代码:</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!doctype <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><br>	<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>消息页面<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"css/mui.min.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><br><span class="css">			<span class="hljs-selector-class">.mui-bar-nav</span> &#123;</span><br><span class="css">				<span class="hljs-selector-tag">background-color</span>: <span class="hljs-selector-id">#4DB361</span>;</span><br>			&#125;<br>			<br><span class="css">			<span class="hljs-selector-class">.galiao-title</span> &#123;</span><br><span class="css">				<span class="hljs-selector-tag">color</span>: <span class="hljs-selector-id">#FFFFFF</span>;</span><br>			&#125;<br>			<br><span class="css">			<span class="hljs-selector-class">.galiao-message</span> <span class="hljs-selector-tag">img</span> &#123;</span><br>				border-radius: 5px;<br>			&#125;<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br>	<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>		<span class="hljs-comment">&lt;!-- 头部 --&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">header</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-bar mui-bar-nav"</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"title"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-title galiao-title"</span>&gt;</span>消息<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span><br><br>		<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-content"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view"</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"receiver in receivers"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"receiver.userId"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view-cell mui-media"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"openChat"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"openChat(receiver)"</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"galiao-message"</span>&gt;</span><br>							<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-media-object mui-pull-left"</span> <span class="hljs-attr">:src</span>=<span class="hljs-string">"receiver.userAvatar"</span>&gt;</span><br>							<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-media-body"</span>&gt;</span><br>								<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-text</span>=<span class="hljs-string">"receiver.userNickname"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>								<span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-ellipsis"</span> <span class="hljs-attr">v-text</span>=<span class="hljs-string">"receiver.messages[receiver.messages.length - 1].data"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>							<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>						<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>					<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/vue/2.6.11/vue.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js/config.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js/mui.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><br>			mui.init()<br><br><span class="javascript">			<span class="hljs-built_in">document</span>.galiao = &#123;</span><br><span class="actionscript">				<span class="hljs-comment">// 后端接口</span></span><br>				url: config.app.sockUrl<br>			&#125;<br><br>			/**<br>			 * 尬聊app初始化<br>			 */<br><span class="actionscript">			<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">galiao_init</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="actionscript">				<span class="hljs-comment">// 创建 socket</span></span><br><span class="javascript">				<span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.WebSocket) &#123;</span><br><span class="actionscript">					<span class="hljs-comment">// 构建socket</span></span><br><span class="javascript">					<span class="hljs-built_in">window</span>.sock = <span class="hljs-keyword">new</span> WebSocket(<span class="hljs-built_in">document</span>.galiao.url)</span><br><span class="actionscript">					<span class="hljs-comment">// 刚建立连接时需要mark一下（让服务端把你的channel和尬聊号建立联系）</span></span><br><span class="javascript">					<span class="hljs-built_in">window</span>.sock.onopen = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>&#123;</span><br><span class="javascript">						<span class="hljs-built_in">window</span>.sock.send(<span class="hljs-built_in">JSON</span>.stringify(&#123;</span><br><span class="actionscript">							action: <span class="hljs-string">'mark'</span>,</span><br>							token: vue.$data.user.token<br>						&#125;))<br>					&#125;<br><br><span class="actionscript">					<span class="hljs-comment">// 服务端有消息推送</span></span><br><span class="javascript">					<span class="hljs-built_in">window</span>.sock.onmessage = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>&#123;</span><br><span class="actionscript">						<span class="hljs-keyword">var</span> chat = plus.webview.getWebviewById(<span class="hljs-string">'chat'</span>);</span><br>						if (chat) &#123;<br><span class="actionscript">							mui.fire(chat, <span class="hljs-string">'receiveMessage'</span>, &#123;</span><br>								message: event.data<br>							&#125;)<br>							<br><span class="actionscript">							<span class="hljs-comment">// 添加到消息</span></span><br>							vue.receiveNewMessage(event.data)<br>						&#125;<br>					&#125;<br>				&#125;<br>			&#125;<br><br>			/**<br>			 * 调用本页面的 socket 发送消息<br><span class="javascript">			 * @param &#123;<span class="hljs-built_in">Object</span>&#125; message</span><br>			 */<br><span class="actionscript">			<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sendMessage</span><span class="hljs-params">(message)</span> </span>&#123;</span><br><span class="javascript">				<span class="hljs-built_in">window</span>.sock.send(message)</span><br><span class="javascript">				addNewMessage(<span class="hljs-built_in">JSON</span>.parse(message))</span><br>			&#125;<br>			<br>			/**<br>			 * 新增消息栏位<br>			 */<br><span class="actionscript">			<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addReceiver</span><span class="hljs-params">(receiver)</span> </span>&#123;</span><br><span class="javascript">				vue.addReceiver(<span class="hljs-built_in">JSON</span>.parse(receiver))</span><br>			&#125;<br><br><span class="actionscript">			<span class="hljs-comment">// 打开聊天窗口</span></span><br><span class="javascript">			mui(<span class="hljs-built_in">document</span>.body).on(<span class="hljs-string">'tap'</span>, <span class="hljs-string">'#openChat'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="actionscript">				<span class="hljs-keyword">this</span>.click()</span><br>			&#125;)<br>				<br><span class="actionscript">			<span class="hljs-comment">// 添加最新的消息</span></span><br><span class="actionscript">			<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addNewMessage</span><span class="hljs-params">(message)</span> </span>&#123;</span><br>				vue.addNewMessage(message)<br>			&#125;<br>			<br>			/**<br>			 * vue实例<br>			 */<br><span class="actionscript">			<span class="hljs-keyword">var</span> vue = <span class="hljs-keyword">new</span> Vue(&#123;</span><br><span class="actionscript">				el: <span class="hljs-string">'#app'</span>,</span><br>				data: &#123;<br>					user: &#123;&#125;,<br>					receivers: []<br>				&#125;,<br>				methods: &#123;<br>					addReceiver(receiver) &#123;<br><span class="actionscript">						<span class="hljs-comment">// 先判断是否已经存在</span></span><br><span class="actionscript">					    <span class="hljs-keyword">for</span>(receiver1 of <span class="hljs-keyword">this</span>.receivers) &#123;</span><br>							if(receiver1.userId === receiver.userId) <br><span class="actionscript">							<span class="hljs-keyword">this</span>.openChat(receiver1)</span><br><span class="actionscript">							<span class="hljs-keyword">return</span></span><br>						&#125;<br><span class="actionscript">						<span class="hljs-comment">// 添加到消息列表</span></span><br>						receiver.messages = []<br><span class="actionscript">						<span class="hljs-keyword">this</span>.receivers.push(receiver)</span><br><span class="actionscript">						<span class="hljs-keyword">this</span>.openChat(receiver)</span><br>					&#125;,<br>					openChat(receiver) &#123;<br>						mui.openWindow(&#123;<br><span class="actionscript">							url: <span class="hljs-string">'chat.html'</span>,</span><br><span class="actionscript">							id: <span class="hljs-string">'chat'</span>,</span><br>							extras: &#123;<br>								receiver: receiver<br>							&#125;<br>						&#125;);<br>					&#125;,<br><span class="actionscript">					<span class="hljs-comment">// 添加最新消息</span></span><br>					addNewMessage(message) &#123;<br><span class="actionscript">						<span class="hljs-keyword">for</span>(receiver of <span class="hljs-keyword">this</span>.receivers) &#123;</span><br>							if(receiver.userId === message.receiver)  &#123;<br>								receiver.messages.push(message)<br>							&#125;<br>						&#125;<br>					&#125;,<br><span class="actionscript">					<span class="hljs-comment">// 收到新消息</span></span><br>					receiveNewMessage(message) &#123;<br><span class="javascript">						<span class="hljs-keyword">let</span> inMessage = <span class="hljs-built_in">JSON</span>.parse(message)</span><br><span class="actionscript">						<span class="hljs-keyword">for</span>(receiver of <span class="hljs-keyword">this</span>.receivers) &#123;</span><br>							if(receiver.userId === inMessage.sender)  &#123;<br>								receiver.messages.push(inMessage)<br>							&#125;<br>						&#125;<br>					&#125;<br>				&#125;,<br>				created() &#123;<br><span class="javascript">					<span class="hljs-keyword">let</span> that = <span class="hljs-keyword">this</span></span><br><span class="actionscript">					mui.plusReady(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="actionscript">						<span class="hljs-comment">// 初始化</span></span><br>						galiao_init();<br><span class="javascript">						that.user = <span class="hljs-built_in">JSON</span>.parse(plus.storage.getItem(<span class="hljs-string">'user'</span>))</span><br>					&#125;)<br>				&#125;<br>			&#125;)<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>消息页面效果：</p>
</blockquote>
<p><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429135658255.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="联系人页面"></p>
<blockquote>
<p><strong>该页面构建了一个websocket对象供聊天信息的发送和接受，但该对象只能在本页面使用，其他页面（chat.html）需要调用本页面方法来发送消息。该页面收到消息直接传给chat页面，chat页面进行判断后选择显示或忽略。该页面涉及到消息数据的保存功能请参见代码。</strong></p>
</blockquote>
<h3 id="联系人页面（friends-html）"><a href="#联系人页面（friends-html）" class="headerlink" title="联系人页面（friends.html）"></a>联系人页面（friends.html）</h3><blockquote>
<p>前端代码：</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!doctype <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><br>	<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>联系人页面<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"css/mui.min.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span>&gt;</span><br><span class="css">			<span class="hljs-selector-class">.mui-bar-nav</span> &#123;</span><br><span class="css">				<span class="hljs-selector-tag">background-color</span>: <span class="hljs-selector-id">#4DB361</span>;</span><br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-title</span> &#123;</span><br><span class="css">				<span class="hljs-selector-tag">color</span>: <span class="hljs-selector-id">#FFFFFF</span>;</span><br>			&#125;<br>			<br><span class="css">			<span class="hljs-selector-class">.galiao-friend</span> <span class="hljs-selector-tag">img</span> &#123;</span><br>				border-radius: 5px;<br>			&#125;<br>			<br><span class="css">			<span class="hljs-selector-id">#topPopover</span> &#123;</span><br>				position: fixed;<br>				top: 16px;<br>				right: 6px;<br>			&#125;<br><span class="css">			<span class="hljs-selector-id">#topPopover</span> <span class="hljs-selector-class">.mui-popover-arrow</span> &#123;</span><br>				left: auto;<br>				right: 6px;<br>			&#125;<br><span class="css">			<span class="hljs-selector-class">.mui-popover</span> &#123;</span><br>				width: 140px;<br>				height: 100px;<br>			&#125;<br>			<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br>	<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><br>		<span class="hljs-comment">&lt;!-- 头部 --&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">header</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-bar mui-bar-nav"</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"title"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-title galiao-title"</span>&gt;</span>联系人<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#topPopover"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-icon mui-icon-plus mui-pull-right galiao-title"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span><br><br>		<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-content"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view"</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"friend in user.friends"</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"friend.userId != user.userId"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"openFriendInfo(friend)"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"friend.userId"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view-cell mui-media"</span></span><br><span class="hljs-tag">					 <span class="hljs-attr">id</span>=<span class="hljs-string">"open_friend_info"</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"galiao-friend"</span>&gt;</span><br>							<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-media-object mui-pull-left"</span> <span class="hljs-attr">:src</span>=<span class="hljs-string">"friend.userAvatar"</span>&gt;</span><br>							<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"padding-top: 10px;"</span> <span class="hljs-attr">v-text</span>=<span class="hljs-string">"friend.userNickname"</span>&gt;</span><br>							<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>						<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>					<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>			<br>			<span class="hljs-comment">&lt;!--右上角弹出菜单--&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"topPopover"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-popover"</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-popover-arrow"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-scroll-wrapper"</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-scroll"</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view"</span>&gt;</span><br>							<span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view-cell"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn_sao"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"saoClick"</span>&gt;</span><br>								<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"javascript:;"</span>&gt;</span><br>									<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-media-object mui-pull-left"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 18px; height: 18px;"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"img/sao.png"</span> /&gt;</span><br>									扫一扫<br>								<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>							<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>							<span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view-cell"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn_ssou"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"souClick"</span>&gt;</span><br>								<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"javascript:;"</span>&gt;</span><br>									<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-media-object mui-pull-left"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 18px; height: 18px;"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"img/sou.png"</span> /&gt;</span><br>									搜索好友<br>								<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>							<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>						<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br>					<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/vue/2.6.11/vue.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js/mui.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><br>			mui.init()<br><br><span class="actionscript">			<span class="hljs-comment">// 点击事件</span></span><br><span class="javascript">			mui(<span class="hljs-built_in">document</span>.body).on(<span class="hljs-string">'tap'</span>, <span class="hljs-string">'#open_friend_info'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="actionscript">				<span class="hljs-keyword">this</span>.click()</span><br>			&#125;)<br><span class="actionscript">			<span class="hljs-comment">// 点击扫一扫</span></span><br><span class="javascript">			mui(<span class="hljs-built_in">document</span>.body).on(<span class="hljs-string">'tap'</span>, <span class="hljs-string">'#btn_sao'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="actionscript">				<span class="hljs-keyword">this</span>.click()</span><br>			&#125;)<br><span class="actionscript">			<span class="hljs-comment">// 点击搜索</span></span><br><span class="javascript">			mui(<span class="hljs-built_in">document</span>.body).on(<span class="hljs-string">'tap'</span>, <span class="hljs-string">'#btn_sou'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="actionscript">				<span class="hljs-keyword">this</span>.click()</span><br>			&#125;)<br><br>			/**<br>			 * vue实例<br>			 */<br><span class="actionscript">			<span class="hljs-keyword">var</span> vue = <span class="hljs-keyword">new</span> Vue(&#123;</span><br><span class="actionscript">				el: <span class="hljs-string">'#app'</span>,</span><br>				data: &#123;<br>					user: &#123;&#125;<br>				&#125;,<br>				methods: &#123;<br>					init() &#123;<br><span class="javascript">						<span class="hljs-keyword">this</span>.user = <span class="hljs-built_in">JSON</span>.parse(plus.storage.getItem(<span class="hljs-string">'user'</span>))</span><br>					&#125;,<br>					openFriendInfo(friend) &#123;<br>						mui.openWindow(&#123;<br><span class="actionscript">							url: <span class="hljs-string">'friend_info.html'</span>,</span><br><span class="actionscript">							id: <span class="hljs-string">'friend_info'</span>,</span><br>							extras: &#123;<br>								userId: friend.userId<br>							&#125;<br>						&#125;);<br>					&#125;,<br>					saoClick() &#123;<br>						mui.openWindow(&#123;<br><span class="actionscript">							url: <span class="hljs-string">'sao.html'</span>,</span><br><span class="actionscript">							id: <span class="hljs-string">'sao'</span></span><br>						&#125;);<br><span class="actionscript">						mui(<span class="hljs-string">'#topPopover'</span>).popover(<span class="hljs-string">'toggle'</span>);  <span class="hljs-comment">// 关闭弹出菜单</span></span><br>					&#125;,<br>					souClick() &#123;<br>						mui.openWindow(&#123;<br><span class="actionscript">							url: <span class="hljs-string">'sou.html'</span>,</span><br><span class="actionscript">							id: <span class="hljs-string">'sou'</span></span><br>						&#125;);<br><span class="actionscript">						mui(<span class="hljs-string">'#topPopover'</span>).popover(<span class="hljs-string">'toggle'</span>);</span><br>					&#125;<br>				&#125;,<br>				created() &#123;<br><span class="javascript">					<span class="hljs-keyword">let</span> that = <span class="hljs-keyword">this</span></span><br><span class="actionscript">					mui.plusReady(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>&#123;</span><br>						that.init()<br>					&#125;)<br>				&#125;<br>			&#125;)<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>页面效果：</p>
</blockquote>
<p><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429135658268.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="在这里插入图片描述"></p>
<blockquote>
<p> 联系人页面和消息页面比较相似，可以 copy 一部分。</p>
</blockquote>
<h3 id="发现页面-（found-html）"><a href="#发现页面-（found-html）" class="headerlink" title="发现页面 （found.html）"></a>发现页面 （found.html）</h3><blockquote>
<p>前端代码：</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!doctype <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><br>	<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>发现页面<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"css/mui.min.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span>&gt;</span><br><span class="css">			<span class="hljs-selector-class">.mui-bar-nav</span> &#123;</span><br><span class="css">				<span class="hljs-selector-tag">background-color</span>: <span class="hljs-selector-id">#4DB361</span> ;</span><br>			&#125;<br><span class="css">			<span class="hljs-selector-class">.galiao-title</span> &#123;</span><br><span class="css">				<span class="hljs-selector-tag">color</span>: <span class="hljs-selector-id">#FFFFFF</span>;</span><br>			&#125;<br><span class="css">			<span class="hljs-selector-class">.galiao-li</span> &#123;</span><br>				height: 45px;<br>			&#125;<br><span class="css">			<span class="hljs-selector-class">.galiao-li</span> <span class="hljs-selector-tag">img</span> &#123;</span><br>				width: 25px;<br>				padding-bottom: 15px;<br>			&#125;<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br>	<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>		<br>		<span class="hljs-comment">&lt;!-- 头部 --&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">header</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-bar mui-bar-nav"</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"title"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-title galiao-title"</span>&gt;</span>发现<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span><br>		<br>		<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-content"</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view"</span>&gt;</span><br>					<span class="hljs-comment">&lt;!-- 毒鸡汤栏目 --&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"dujitang"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view-cell mui-media galiao-li"</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-navigate-right"</span>&gt;</span><br>							<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-media-object mui-pull-left"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"img/du.png"</span>&gt;</span><br>							<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"padding-top: 3px;"</span>&gt;</span><br>								毒鸡汤（每日一毒）<br>							<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>						<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>					<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>					<span class="hljs-comment">&lt;!-- 代做决定栏目 --&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"decision"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view-cell mui-media galiao-li"</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-navigate-right"</span>&gt;</span><br>							<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-media-object mui-pull-left"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"img/decision.png"</span>&gt;</span><br>							<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"padding-top: 3px;"</span>&gt;</span><br>								代做决定<br>							<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>						<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>					<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>		<br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js/mui.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><br>			mui.init()<br>			<br><span class="actionscript">			<span class="hljs-comment">// 打开毒鸡汤页面</span></span><br><span class="javascript">			mui(<span class="hljs-built_in">document</span>.body).on(<span class="hljs-string">'tap'</span>, <span class="hljs-string">'#dujitang'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>&#123;</span><br>				 mui.openWindow(&#123;<br><span class="actionscript">				    url: <span class="hljs-string">'du.html'</span>, </span><br><span class="actionscript">				    id:<span class="hljs-string">'du'</span></span><br>				  &#125;);<br>			&#125;)<br>			<br><span class="actionscript">			<span class="hljs-comment">// 打开代做决定页面</span></span><br><span class="javascript">			mui(<span class="hljs-built_in">document</span>.body).on(<span class="hljs-string">'tap'</span>, <span class="hljs-string">'#decision'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>&#123;</span><br>				 mui.openWindow(&#123;<br><span class="actionscript">				    url: <span class="hljs-string">'decision.html'</span>, </span><br><span class="actionscript">				    id:<span class="hljs-string">'decision'</span></span><br>				  &#125;);<br>			&#125;)<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>这个页面主要负责打开其他页面，目前主要打开 du.html 和 decision.html，这两个页面目前主要还是 js 在玩，没有 ajax 操作。可在【<a href="https://gitee.com/junanaa/galiao-mui" target="_blank" rel="noopener">尬聊开源地址</a>】查看。</p>
</blockquote>
<h3 id="我的页面（mine-html）"><a href="#我的页面（mine-html）" class="headerlink" title="我的页面（mine.html）"></a>我的页面（mine.html）</h3><blockquote>
<p>前端代码：</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!doctype <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><br>	<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>我的页面<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"css/mui.min.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span>&gt;</span><br><span class="css">			<span class="hljs-selector-class">.mui-bar-nav</span> &#123;</span><br><span class="css">				<span class="hljs-selector-tag">background-color</span>: <span class="hljs-selector-id">#4DB361</span>;</span><br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-li</span> &#123;</span><br>				height: 45px;<br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-title</span> &#123;</span><br><span class="css">				<span class="hljs-selector-tag">color</span>: <span class="hljs-selector-id">#FFFFFF</span>;</span><br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-mine-header</span> &#123;</span><br>				width: 100%;<br>				height: 150px;<br><span class="css">				<span class="hljs-selector-tag">background-color</span>: <span class="hljs-selector-id">#FFFFFF</span>;</span><br>				padding-top: 16%;<br>				padding-left: 10%;<br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-mine-header</span> <span class="hljs-selector-tag">img</span> &#123;</span><br>				width: 60px;<br>				height: 60px;<br>				border-radius: 6px;<br>				margin-right: 22px;<br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-mine-header</span> <span class="hljs-selector-tag">div</span> &#123;</span><br>				padding-top: 10px;<br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-mine-header-title</span> &#123;</span><br><span class="css">				<span class="hljs-selector-tag">color</span>: <span class="hljs-selector-id">#000000</span>;</span><br>				font-size: 24px;<br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-mine-header-desc</span> &#123;</span><br>				font-size: 14px;<br><span class="css">				<span class="hljs-selector-tag">color</span>: <span class="hljs-selector-id">#8F8F94</span>;</span><br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-mine</span> <span class="hljs-selector-tag">ul</span>,</span><br><span class="css">			<span class="hljs-selector-class">.galiao-mine</span> <span class="hljs-selector-tag">div</span> &#123;</span><br>				margin-bottom: 20px;<br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-quit-login</span> &#123;</span><br>				width: 100%;<br>				height: 40px;<br>			&#125;<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br>	<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><br>		<span class="hljs-comment">&lt;!-- 头部 --&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">header</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-bar mui-bar-nav"</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"title"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-title galiao-title"</span>&gt;</span>我的<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span><br><br>		<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-content"</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"galiao-mine"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"galiao_mine"</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"galiao-mine-header"</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"float: left;"</span> <span class="hljs-attr">:src</span>=<span class="hljs-string">"user.userAvatar"</span> /&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"galiao-mine-header-title"</span> <span class="hljs-attr">v-text</span>=<span class="hljs-string">"user.userNickname"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"galiao-mine-header-desc"</span>&gt;</span>尬聊号：<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-text</span>=<span class="hljs-string">"user.userId"</span>&gt;</span>&gt;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>					<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>				<span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view"</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view-cell"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn_replace_avatar"</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-navigate-right"</span>&gt;</span>头像<br>							<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-pull-right"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 35px; height: 35px; margin-right: 20px;"</span> <span class="hljs-attr">:src</span>=<span class="hljs-string">"user.userAvatar"</span> /&gt;</span><br>						<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>					<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view-cell"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn_replace_nickname"</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-navigate-right"</span>&gt;</span>昵称<br>							<span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-pull-right"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">" margin-right: 20px;"</span> <span class="hljs-attr">v-text</span>=<span class="hljs-string">"user.userNickname"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>						<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>					<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view-cell"</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-navigate-right"</span>&gt;</span>尬聊号<br>							<span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-pull-right"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">" margin-right: 20px;"</span> <span class="hljs-attr">v-text</span>=<span class="hljs-string">"user.userId"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>						<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>					<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view-cell"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn_show_qrcode"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"showQrcode"</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-navigate-right"</span>&gt;</span>我的二维码<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>					<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br><br>				<span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view"</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view-cell"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn_show_admire"</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-navigate-right"</span>&gt;</span>赞赏<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>					<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view-cell"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn_show_about"</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-navigate-right"</span>&gt;</span>关于<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>					<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br><br>				<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn_quit_login"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-btn mui-btn-danger galiao-quit-login"</span>&gt;</span>退出登录<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/vue/2.6.11/vue.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/axios/0.19.2/axios.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js/mui.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js/app.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><br>			mui.init()<br><br><span class="actionscript">			<span class="hljs-comment">// 更换头像</span></span><br><span class="javascript">			mui(<span class="hljs-built_in">document</span>.body).on(<span class="hljs-string">'tap'</span>, <span class="hljs-string">'#btn_replace_avatar'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="actionscript">				mui.alert(<span class="hljs-string">"该功能暂无法使用哦！"</span>)</span><br>			&#125;)<br><br><span class="actionscript">			<span class="hljs-comment">// 更换昵称</span></span><br><span class="javascript">			mui(<span class="hljs-built_in">document</span>.body).on(<span class="hljs-string">'tap'</span>, <span class="hljs-string">'#btn_replace_nickname'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="actionscript">				mui.alert(<span class="hljs-string">"该功能暂无法使用哦！"</span>)</span><br>			&#125;)<br><br><span class="actionscript">			<span class="hljs-comment">// 展示二维码</span></span><br><span class="javascript">			mui(<span class="hljs-built_in">document</span>.body).on(<span class="hljs-string">'tap'</span>, <span class="hljs-string">'#btn_show_qrcode'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="actionscript">				<span class="hljs-keyword">this</span>.click()</span><br>			&#125;)<br><br><span class="actionscript">			<span class="hljs-comment">// 赞赏</span></span><br><span class="javascript">			mui(<span class="hljs-built_in">document</span>.body).on(<span class="hljs-string">'tap'</span>, <span class="hljs-string">'#btn_show_admire'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="actionscript">				mui.alert(<span class="hljs-string">"小朋友，省点钱买辣条吃！"</span>)</span><br>			&#125;)<br><br><span class="actionscript">			<span class="hljs-comment">// 关于</span></span><br><span class="javascript">			mui(<span class="hljs-built_in">document</span>.body).on(<span class="hljs-string">'tap'</span>, <span class="hljs-string">'#btn_show_about'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="actionscript">				<span class="hljs-comment">//打开about页面</span></span><br>				mui.openWindow(&#123;<br><span class="actionscript">					url: <span class="hljs-string">'about.html'</span>,</span><br><span class="actionscript">					id: <span class="hljs-string">'about'</span></span><br>				&#125;);<br>			&#125;)<br><br><span class="actionscript">			<span class="hljs-comment">// 退出登录</span></span><br><span class="javascript">			mui(<span class="hljs-built_in">document</span>.body).on(<span class="hljs-string">'tap'</span>, <span class="hljs-string">'#btn_quit_login'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="actionscript">				<span class="hljs-comment">// 清理缓存</span></span><br>				clearCache()<br><span class="actionscript">				<span class="hljs-comment">//打开login页面</span></span><br>				mui.openWindow(&#123;<br><span class="actionscript">					url: <span class="hljs-string">'login.html'</span>,</span><br><span class="actionscript">					id: <span class="hljs-string">'login'</span></span><br>				&#125;);<br><span class="actionscript">				<span class="hljs-comment">// 调用login的方法清除其他页面</span></span><br><span class="actionscript">				<span class="hljs-keyword">var</span> login = plus.webview.getWebviewById(<span class="hljs-string">'login'</span>);</span><br><span class="actionscript">				mui.fire(login, <span class="hljs-string">'clearOtherHtml'</span>)</span><br>			&#125;)<br><br><span class="actionscript">			<span class="hljs-keyword">var</span> vue = <span class="hljs-keyword">new</span> Vue(&#123;</span><br><span class="actionscript">				el: <span class="hljs-string">'#galiao_mine'</span>,</span><br>				data: &#123;<br>					user: &#123;<br><span class="actionscript">						userId: <span class="hljs-string">''</span>,</span><br><span class="actionscript">						userNickname: <span class="hljs-string">''</span>,</span><br><span class="actionscript">						userAvatar: <span class="hljs-string">''</span></span><br>					&#125;<br>				&#125;,<br>				methods: &#123;<br>					showQrcode() &#123;<br><span class="javascript">						<span class="hljs-keyword">let</span> that = <span class="hljs-keyword">this</span></span><br>						mui.openWindow(&#123;<br><span class="actionscript">							url: <span class="hljs-string">'mine_qrcode.html'</span>,</span><br><span class="actionscript">							id: <span class="hljs-string">'mine_qrcode'</span>,</span><br>							extras: &#123;<br>								userId: that.user.userId<br>							&#125;<br>						&#125;);<br>					&#125;<br>				&#125;,<br>				created() &#123;<br><span class="javascript">					<span class="hljs-keyword">let</span> that = <span class="hljs-keyword">this</span></span><br><span class="actionscript">					mui.plusReady(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="javascript">						that.user = <span class="hljs-built_in">JSON</span>.parse(plus.storage.getItem(<span class="hljs-string">'user'</span>))</span><br>					&#125;)<br>				&#125;<br>			&#125;)<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>页面效果：<br><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429135658315.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="我的页面"><br>这个页面目前主要实现了我的二维码展示、关于、退出三个功能，后续可以做其他功能。</p>
</blockquote>
<h3 id="好友信息页面（friend-info-html）"><a href="#好友信息页面（friend-info-html）" class="headerlink" title="好友信息页面（friend_info.html）"></a>好友信息页面（friend_info.html）</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!doctype <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><br>	<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>好友信息页面<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"css/mui.min.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span>&gt;</span><br><span class="css">			<span class="hljs-selector-class">.mui-bar-nav</span> &#123;</span><br><span class="css">				<span class="hljs-selector-tag">background-color</span>: <span class="hljs-selector-id">#4DB361</span>;</span><br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-btn-return</span> &#123;</span><br><span class="css">				<span class="hljs-selector-tag">color</span>: <span class="hljs-selector-id">#FFFFFF</span>;</span><br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-li</span> &#123;</span><br>				height: 45px;<br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-title</span> &#123;</span><br><span class="css">				<span class="hljs-selector-tag">color</span>: <span class="hljs-selector-id">#FFFFFF</span>;</span><br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-mine-header</span> &#123;</span><br>				width: 100%;<br>				height: 150px;<br><span class="css">				<span class="hljs-selector-tag">background-color</span>: <span class="hljs-selector-id">#FFFFFF</span>;</span><br>				padding-top: 16%;<br>				padding-left: 10%;<br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-mine-header</span> <span class="hljs-selector-tag">img</span> &#123;</span><br>				width: 60px;<br>				height: 60px;<br>				border-radius: 6px;<br>				margin-right: 22px;<br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-mine-header</span> <span class="hljs-selector-tag">div</span> &#123;</span><br>				padding-top: 10px;<br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-mine-header-title</span> &#123;</span><br><span class="css">				<span class="hljs-selector-tag">color</span>: <span class="hljs-selector-id">#000000</span>;</span><br>				font-size: 24px;<br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-mine</span> <span class="hljs-selector-tag">ul</span> &#123;</span><br>				margin-bottom: 20px;<br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-mine-header-desc</span> &#123;</span><br>				font-size: 14px;<br><span class="css">				<span class="hljs-selector-tag">color</span>: <span class="hljs-selector-id">#8F8F94</span>;</span><br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-quit-login</span> &#123;</span><br>				width: 100%;<br>				height: 40px;<br>			&#125;<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br>	<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><br>		<span class="hljs-tag">&lt;<span class="hljs-name">header</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-bar mui-bar-nav"</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-action-back mui-icon mui-icon-left-nav mui-pull-left galiao-btn-return"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span><br><br>		<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-content"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"galiao-mine"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"galiao_mine"</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"galiao-mine-header"</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"float: left;"</span> <span class="hljs-attr">:src</span>=<span class="hljs-string">"user.userAvatar"</span> /&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"galiao-mine-header-title"</span> <span class="hljs-attr">v-text</span>=<span class="hljs-string">"user.userNickname"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"galiao-mine-header-desc"</span>&gt;</span>尬聊号：<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-text</span>=<span class="hljs-string">"user.userId"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span> <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>					<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>				<span class="hljs-comment">&lt;!-- 已经是好友显示 --&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view"</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"user.isFriend"</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view-cell"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn_set_remark"</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-navigate-right"</span>&gt;</span><br>							设置备注和标签<br>						<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>					<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view"</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"user.isFriend"</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view-cell"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn_send_message"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"openChat"</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"text-align: center; color: dimgray;"</span>&gt;</span><br>							<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-icon mui-icon-chatbubble"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 25px; height: 25px;"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>							发消息<br>						<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>					<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br><br>				<span class="hljs-comment">&lt;!-- 不是好友显示 --&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view"</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"user.isFriend == false"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"margin-top: 20px;"</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view-cell"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn_add_friend"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"addFriend"</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"text-align: center; color: dimgray;"</span>&gt;</span><br>							<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"img/add_friend.png"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-icon mui-icon-chatbubble"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 20px; height: 20px; margin-bottom: -3px;"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">img</span>&gt;</span><br>							添加好友<br>						<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>					<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js/config.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/vue/2.6.11/vue.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/axios/0.19.2/axios.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js/mui.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><br>			mui.init()<br><br><span class="actionscript">			<span class="hljs-comment">// 点击发消息按钮</span></span><br><span class="javascript">			mui(<span class="hljs-built_in">document</span>.body).on(<span class="hljs-string">'tap'</span>, <span class="hljs-string">'#btn_send_message'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="actionscript">				<span class="hljs-keyword">this</span>.click()</span><br>			&#125;)<br><br><span class="actionscript">			<span class="hljs-comment">// 点击设置备注按钮</span></span><br><span class="javascript">			mui(<span class="hljs-built_in">document</span>.body).on(<span class="hljs-string">'tap'</span>, <span class="hljs-string">'#btn_set_remark'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="actionscript">				mui.alert(<span class="hljs-string">"该功能暂无法使用哦！"</span>)</span><br>			&#125;)<br><br><span class="actionscript">			<span class="hljs-comment">// 点击添加好友</span></span><br><span class="javascript">			mui(<span class="hljs-built_in">document</span>.body).on(<span class="hljs-string">'tap'</span>, <span class="hljs-string">'#btn_add_friend'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="actionscript">				<span class="hljs-comment">// this.click()</span></span><br><span class="actionscript">				mui.alert(<span class="hljs-string">"该功能暂无法使用哦！"</span>)</span><br>			&#125;)<br><br>			/**<br>			 * vue实例<br>			 */<br><span class="actionscript">			<span class="hljs-keyword">var</span> vue = <span class="hljs-keyword">new</span> Vue(&#123;</span><br><span class="actionscript">				el: <span class="hljs-string">'#app'</span>,</span><br>				data: &#123;<br>					user: &#123;<br><span class="actionscript">						userId: <span class="hljs-string">''</span>,</span><br><span class="actionscript">						userNickname: <span class="hljs-string">''</span>,</span><br><span class="actionscript">						userAvatar: <span class="hljs-string">''</span>,</span><br><span class="actionscript">						isFriend: <span class="hljs-literal">false</span></span><br>					&#125;<br>				&#125;,<br>				methods: &#123;<br><span class="actionscript">					<span class="hljs-comment">// 打开聊天界面</span></span><br>					openChat() &#123;<br><span class="javascript">						<span class="hljs-keyword">let</span> that = <span class="hljs-keyword">this</span></span><br><span class="actionscript">						<span class="hljs-comment">// 不能和自己聊天</span></span><br><span class="javascript">						<span class="hljs-keyword">if</span> (that.user.userId == <span class="hljs-built_in">JSON</span>.parse(plus.storage.getItem(<span class="hljs-string">'user'</span>)).userId) &#123;</span><br><span class="actionscript">							mui.alert(<span class="hljs-string">"无法和自己聊天！"</span>)</span><br><span class="actionscript">							<span class="hljs-keyword">return</span></span><br>						&#125;<br><br><span class="actionscript">						<span class="hljs-comment">// message 页面新增消息栏 </span></span><br><span class="javascript">						<span class="hljs-keyword">this</span>.messageView.evalJS(<span class="hljs-string">"addReceiver('"</span> + <span class="hljs-built_in">JSON</span>.stringify(that.user) + <span class="hljs-string">"')"</span>)</span><br>					&#125;,<br><span class="actionscript">					<span class="hljs-comment">// 添加好友</span></span><br>					addFriend() &#123;<br><span class="javascript">						<span class="hljs-keyword">let</span> that = <span class="hljs-keyword">this</span></span><br><span class="actionscript">						axios.post(config.app.baseUrl + <span class="hljs-string">'/user/friend/'</span> + that.user.userId, <span class="hljs-literal">null</span>, &#123;</span><br>								params: &#123;<br><span class="javascript">									token: <span class="hljs-built_in">JSON</span>.parse(plus.storage.getItem(<span class="hljs-string">'user'</span>)).token</span><br>								&#125;<br>							&#125;)<br><span class="actionscript">							.then(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(res)</span> </span>&#123;</span><br><span class="actionscript">								<span class="hljs-keyword">var</span> data = res.data</span><br>								if (data.code != 1) &#123;<br>									mui.alert(data.data)<br><span class="actionscript">									<span class="hljs-keyword">return</span></span><br>								&#125;<br><span class="actionscript">								mui.alert(<span class="hljs-string">"添加成功！"</span>)</span><br>								that.openChat()<br><span class="actionscript">								<span class="hljs-comment">// 更新本地数据</span></span><br>								<br>								<br>							&#125;)<br><span class="actionscript">							.catch(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(error)</span> </span>&#123;</span><br><span class="actionscript">								mui.alert(<span class="hljs-string">"网络异常！"</span>)</span><br>							&#125;);<br><br>					&#125;<br>				&#125;,<br>				created() &#123;<br><span class="javascript">					<span class="hljs-keyword">let</span> that = <span class="hljs-keyword">this</span></span><br><span class="actionscript">					mui.plusReady(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="actionscript">						<span class="hljs-comment">// 获取上个页面传来的参数</span></span><br>						that.user.userId = plus.webview.currentWebview().userId<br><br><span class="actionscript">						<span class="hljs-comment">//获取 message 页面</span></span><br><span class="actionscript">						<span class="hljs-keyword">var</span> wvs = plus.webview.all()</span><br><span class="actionscript">						<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, len = wvs.length; i &lt; len; i++) &#123;</span><br><span class="actionscript">							<span class="hljs-comment">// 获取建立socket连接的 message 页面</span></span><br><span class="actionscript">							<span class="hljs-keyword">if</span> (wvs[i].id == <span class="hljs-string">'message'</span>) &#123;</span><br>								vue.messageView = wvs[i]<br><span class="actionscript">								<span class="hljs-keyword">break</span></span><br>							&#125;<br>						&#125;<br><br><span class="actionscript">						<span class="hljs-comment">// 获取好友信息</span></span><br>						if (that.user.userId) &#123;<br><span class="actionscript">							axios.get(config.app.baseUrl + <span class="hljs-string">'/user/'</span> + that.user.userId, &#123;</span><br>									params: &#123;<br><span class="javascript">										token: <span class="hljs-built_in">JSON</span>.parse(plus.storage.getItem(<span class="hljs-string">'user'</span>)).token</span><br>									&#125;<br>								&#125;)<br><span class="actionscript">								.then(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(res)</span> </span>&#123;</span><br><span class="actionscript">									<span class="hljs-keyword">var</span> data = res.data</span><br>									if (data.code != 1) &#123;<br>										mui.alert(data.data)<br><span class="actionscript">										<span class="hljs-keyword">return</span></span><br>									&#125;<br>									that.user = data.data<br>								&#125;)<br><span class="actionscript">								.catch(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(error)</span> </span>&#123;</span><br><span class="javascript">									<span class="hljs-built_in">console</span>.log(error)</span><br>								&#125;);<br>						&#125;<br><br>					&#125;)<br><br>				&#125;<br>			&#125;)<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>页面效果：</p>
</blockquote>
<p><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429143710159.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="尬友信息页面"></p>
<blockquote>
<p> 这个页面会根据情况判断，如果不是自己的好友，会显示  添加好友  按钮，如果是自己的好友就显示  发消息  按钮。这一块的判断在服务端，主要逻辑如下：</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Override</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> Message <span class="hljs-title">userById</span><span class="hljs-params">(Long userId, String token)</span> </span>&#123;<br>    <span class="hljs-comment">// 验证token</span><br>    <span class="hljs-keyword">if</span>(checkToken(token)) &#123;<br>        QueryWrapper&lt;User&gt; wrapper = <span class="hljs-keyword">new</span> QueryWrapper&lt;&gt;();<br>        wrapper.eq(<span class="hljs-string">"user_id"</span>, userId);<br>        wrapper.select(<span class="hljs-string">"user_id"</span>, <span class="hljs-string">"user_avatar"</span>, <span class="hljs-string">"user_nickname"</span>);<br>        User user = userMapper.selectOne(wrapper);<br>        <span class="hljs-keyword">if</span>(user == <span class="hljs-keyword">null</span>)<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Message().code(MessageCode.USER_NOT_FOUND.value()).data(<span class="hljs-string">"该用户不存在！"</span>);<br><br>        <span class="hljs-comment">// 用户存在，检查是否是自己的好友</span><br>        <span class="hljs-keyword">boolean</span> isFriend = <span class="hljs-keyword">false</span>;<br>        <span class="hljs-comment">// 获取自己的好友列表</span><br>        String[] split = FastJsonUtil.parseObject(<br>                (String) redisUtil.get(token), User<span class="hljs-class">.<span class="hljs-keyword">class</span>)</span><br><span class="hljs-class">                .<span class="hljs-title">getUserFriends</span>()</span><br>                .split(",");<br>        <span class="hljs-keyword">for</span> (String s : split) &#123;<br>        	<span class="hljs-comment">// 判断是否是自己好友</span><br>            <span class="hljs-keyword">if</span>(user.getUserId().equals(Long.valueOf(s))) &#123;<br>                isFriend = <span class="hljs-keyword">true</span>;<br>                <span class="hljs-keyword">break</span>;<br>            &#125;<br>        &#125;<br>        user.setIsFriend(isFriend);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Message().code(MessageCode.OK.value()).data(user);<br><br>    &#125;<br>    <span class="hljs-comment">// token不合法</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Message().code(MessageCode.FAIL.value()).data(<span class="hljs-string">"token不合法"</span>);<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="聊天页面（chat-html）"><a href="#聊天页面（chat-html）" class="headerlink" title="聊天页面（chat.html）"></a>聊天页面（chat.html）</h3><blockquote>
<p>前端代码：</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!doctype <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>尬聊聊天页面<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"css/mui.min.css"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><br>			body &#123;<br><span class="css">			<span class="hljs-selector-tag">background-color</span>: <span class="hljs-selector-id">#F2F2F2</span>;</span><br>		&#125;<br><span class="css">		<span class="hljs-selector-class">.mui-bar-nav</span> &#123;</span><br><span class="css">			<span class="hljs-selector-tag">background-color</span>: <span class="hljs-selector-id">#4DB361</span> ;</span><br>		&#125;<br><span class="css">		<span class="hljs-selector-class">.galiao-btn-return</span> &#123;</span><br><span class="css">			<span class="hljs-selector-tag">color</span>: <span class="hljs-selector-id">#FFFFFF</span>;</span><br>		&#125;<br><span class="css">		<span class="hljs-selector-class">.galiao-chat-title</span> &#123;</span><br><span class="css">			<span class="hljs-selector-tag">color</span>: <span class="hljs-selector-id">#FFFFFF</span>;</span><br>		&#125;<br><span class="css">		<span class="hljs-selector-class">.galiao-chat-tab</span> &#123;</span><br>			padding: 7px 12px 3px 12px;<br>		&#125;<br><span class="css">		<span class="hljs-selector-class">.galiao-avator</span> &#123;</span><br>			width: 50px;<br>			height: 50px;<br>		&#125;<br><span class="css">		<span class="hljs-selector-class">.mui-table-view</span> &#123;</span><br><span class="css">			<span class="hljs-selector-tag">background-color</span>: <span class="hljs-selector-id">#F2F2F2</span>;</span><br>		&#125;<br><span class="css">		<span class="hljs-selector-class">.mui-table-view</span><span class="hljs-selector-pseudo">:after</span>&#123; <span class="hljs-attribute">height</span>:<span class="hljs-number">0</span>&#125;</span><br><span class="css">		<span class="hljs-selector-class">.mui-table-view</span><span class="hljs-selector-pseudo">:before</span>&#123; <span class="hljs-attribute">height</span>:<span class="hljs-number">0</span>&#125;</span><br><span class="css">		<span class="hljs-selector-class">.mui-table-view-cell</span><span class="hljs-selector-pseudo">:after</span>&#123; <span class="hljs-attribute">height</span>:<span class="hljs-number">0</span>&#125;</span><br><span class="css">		<span class="hljs-selector-class">.mui-table-view-cell</span><span class="hljs-selector-pseudo">:before</span>&#123; <span class="hljs-attribute">height</span>:<span class="hljs-number">0</span>&#125;</span><br>		<br><span class="css">		<span class="hljs-selector-class">.galiao-message-bubble-left</span> &#123;</span><br>			position: relative;<br>			display: inline-block;<br>			padding: 10px 15px 10px 20px;<br>			margin-top: 5px;<br><span class="css">			<span class="hljs-selector-tag">background-color</span>: <span class="hljs-selector-id">#FFFFFF</span>;</span><br>			font-size: 14px;<br>			border-radius: 5px;<br>			margin-left: 20px;<br>			max-width: 260px;<br>		&#125;<br>		<br><span class="css">		<span class="hljs-selector-class">.galiao-message-bubble-left</span><span class="hljs-selector-pseudo">:before</span>, <span class="hljs-selector-class">.galiao-message-bubble-left</span><span class="hljs-selector-pseudo">:after</span> &#123;</span><br><span class="css">			<span class="hljs-selector-tag">content</span>: ""; <span class="hljs-comment">/*:before和:after必带技能，重要性为满5颗星*/</span></span><br>			display: block;<br><span class="css">			<span class="hljs-selector-tag">position</span>: <span class="hljs-selector-tag">absolute</span>; <span class="hljs-comment">/*日常绝对定位*/</span></span><br>			top: 15px;<br>			left: -12px;<br>			border: 6px solid transparent;<br><span class="css">			<span class="hljs-selector-tag">border-right-color</span>: <span class="hljs-selector-id">#FFFFFF</span>;</span><br>			width: 0px;<br>			height: 0px;<br>		&#125;<br>		<br><span class="css">		<span class="hljs-selector-class">.galiao-message-bubble-right</span> &#123;</span><br>			position: relative;<br>			display: inline-block;<br>			padding: 10px 15px 10px 20px;<br>			margin-top: 5px;<br><span class="css">			<span class="hljs-selector-tag">background-color</span>: <span class="hljs-selector-id">#9fe766</span>;</span><br>			font-size: 14px;<br>			border-radius: 5px;<br>			margin-right: 20px;<br>			max-width: 260px;<br>		&#125;<br>		<br><span class="css">		<span class="hljs-selector-class">.galiao-message-bubble-right</span><span class="hljs-selector-pseudo">:before</span>, <span class="hljs-selector-class">.galiao-message-bubble-right</span><span class="hljs-selector-pseudo">:after</span> &#123;</span><br><span class="css">			<span class="hljs-selector-tag">content</span>: ""; <span class="hljs-comment">/*:before和:after必带技能，重要性为满5颗星*/</span></span><br>			display: block;<br><span class="css">			<span class="hljs-selector-tag">position</span>: <span class="hljs-selector-tag">absolute</span>; <span class="hljs-comment">/*日常绝对定位*/</span></span><br>			top: 15px;<br>			right: -10px;<br>			border: 6px solid transparent;<br><span class="css">			<span class="hljs-selector-tag">border-left-color</span>: <span class="hljs-selector-id">#9fe766</span>;</span><br>			width: 0px;<br>			height: 0px;<br>		&#125;<br>		<br><span class="css">		<span class="hljs-selector-class">.galiao-avator</span>&#123;</span><br>			border-radius: 5px;<br>		&#125;<br>	<span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>	<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">header</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-bar mui-bar-nav"</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-action-back mui-icon mui-icon-left-nav mui-pull-left galiao-btn-return"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-title galiao-chat-title"</span> <span class="hljs-attr">v-text</span>=<span class="hljs-string">"receiver.userNickname"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span><br><br>			<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-scroll-wrapper"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"margin: 50px 0 70px 0;"</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-scroll"</span>&gt;</span><br>					<span class="hljs-comment">&lt;!-- 左气泡 --&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"galiao-chat-message"</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">"(message, index) in messageData"</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">"index"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view-cell"</span>&gt;</span><br>							<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"message.action != 'out'"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"galiao-avator mui-pull-left"</span> <span class="hljs-attr">:src</span>=<span class="hljs-string">"receiver.userAvatar"</span> /&gt;</span><br>							<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"message.action != 'out'"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"galiao-message-bubble-left mui-pull-left"</span> <span class="hljs-attr">v-text</span>=<span class="hljs-string">"message.data"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>							<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"message.action == 'out'"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"galiao-avator mui-pull-right"</span> <span class="hljs-attr">:src</span>=<span class="hljs-string">"user.userAvatar"</span> /&gt;</span><br>							<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"message.action == 'out'"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"galiao-message-bubble-right mui-pull-right"</span> <span class="hljs-attr">v-text</span>=<span class="hljs-string">"message.data"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>						<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>					<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><br>			<span class="hljs-tag">&lt;<span class="hljs-name">nav</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-bar mui-bar-tab galiao-chat-tab"</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-icon mui-icon-pengyouquan"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 10%; padding-right: 3px;"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"concurrentMessage"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 60%;border: none;"</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-icon mui-icon-star"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 10%; padding-left: 7px;"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn_send_message"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"sendMessage"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-btn mui-btn-success"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"width: 14%;"</span>&gt;</span>发送<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span><br><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/vue/2.6.11/vue.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js/mui.min.js"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><br>			mui.init()<br><br>			/**<br>			 * 收到消息<br><span class="javascript">			 * @param &#123;<span class="hljs-built_in">Object</span>&#125; event</span><br>			 */<br><span class="javascript">			<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">'receiveMessage'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>) </span>&#123;</span><br><span class="actionscript">				<span class="hljs-comment">//获得事件参数</span></span><br><span class="actionscript">				<span class="hljs-keyword">var</span> message = event.detail.message;</span><br>				vue.receiveMessage(message)<br>			&#125;);<br><br><span class="actionscript">			<span class="hljs-comment">// 按钮点击事件 </span></span><br><span class="javascript">			mui(<span class="hljs-built_in">document</span>.body).on(<span class="hljs-string">'tap'</span>, <span class="hljs-string">'#btn_send_message'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="actionscript">				<span class="hljs-keyword">this</span>.click()</span><br>			&#125;)<br><br>			/**<br>			 * vue实例<br>			 */<br><span class="actionscript">			<span class="hljs-keyword">var</span> vue = <span class="hljs-keyword">new</span> Vue(&#123;</span><br><span class="actionscript">				el: <span class="hljs-string">'#app'</span>,</span><br>				data: &#123;<br>					messageData: [],<br>					user: &#123;&#125;,<br>					receiver: &#123;&#125;<br>				&#125;,<br>				methods: &#123;<br><span class="actionscript">					<span class="hljs-comment">// 发消息</span></span><br>					sendMessage() &#123;<br><span class="javascript">						<span class="hljs-keyword">let</span> message = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'concurrentMessage'</span>).value</span><br><span class="actionscript">						<span class="hljs-keyword">if</span> (message != <span class="hljs-string">''</span>) &#123;</span><br><span class="actionscript">							<span class="hljs-comment">// 构建传输的消息格式</span></span><br><span class="javascript">							<span class="hljs-keyword">let</span> msg = &#123;</span><br><span class="actionscript">								action: <span class="hljs-string">'out'</span>, <span class="hljs-comment">// 操作类型</span></span><br><span class="actionscript">								receiver: <span class="hljs-keyword">this</span>.receiver.userId, <span class="hljs-comment">// 接受者尬聊号</span></span><br><span class="actionscript">								data: message, <span class="hljs-comment">// 信息</span></span><br><span class="actionscript">								token: <span class="hljs-keyword">this</span>.user.token <span class="hljs-comment">// token</span></span><br>							&#125;<br><span class="actionscript">							<span class="hljs-comment">// 调用父页面发送消息</span></span><br><span class="javascript">							<span class="hljs-keyword">this</span>.socketView.evalJS(<span class="hljs-string">"sendMessage('"</span> + <span class="hljs-built_in">JSON</span>.stringify(msg) + <span class="hljs-string">"')"</span>)</span><br><span class="actionscript">							<span class="hljs-keyword">this</span>.messageData.push(msg)</span><br><span class="javascript">							<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'concurrentMessage'</span>).value = <span class="hljs-string">''</span></span><br><span class="javascript">							<span class="hljs-keyword">let</span> that = <span class="hljs-keyword">this</span></span><br><span class="actionscript">							setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>&#123;</span><br>								that.movieToBottom()<br>							&#125;, 100)<br>						&#125;<br>					&#125;,<br><span class="actionscript">					<span class="hljs-comment">// 接收消息</span></span><br>					receiveMessage(message) &#123;<br><span class="javascript">						<span class="hljs-keyword">let</span> inMessage = <span class="hljs-built_in">JSON</span>.parse(message)</span><br><span class="actionscript">						<span class="hljs-keyword">if</span> (inMessage.sender === <span class="hljs-keyword">this</span>.receiver.userId) &#123;</span><br><span class="javascript">							<span class="hljs-keyword">let</span> that = <span class="hljs-keyword">this</span></span><br>							that.messageData.push(&#123;<br><span class="actionscript">								action: <span class="hljs-string">'in'</span>,</span><br>								data: inMessage.data<br>							&#125;)<br><span class="actionscript">							<span class="hljs-comment">// 如果直接调用是没效果的，可能还没挂载吧，等个100ms后已经挂载完成</span></span><br><span class="actionscript">							setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>&#123;</span><br>								that.movieToBottom()<br>							&#125;, 100)<br>						&#125;<br>					&#125;,<br><span class="actionscript">					<span class="hljs-comment">// 窗口移动到底部（每次发完消息时和初始化时）</span></span><br>					movieToBottom() &#123;<br><span class="actionscript">						<span class="hljs-comment">// 让页面一直显示最底部</span></span><br><span class="actionscript">						<span class="hljs-keyword">var</span> scroll = mui(<span class="hljs-string">'.mui-scroll-wrapper'</span>).scroll();</span><br>						scroll.reLayout();<br><span class="actionscript">						<span class="hljs-comment">//滚动到底部</span></span><br>						scroll.scrollToBottom(100);<br>					&#125;<br>				&#125;,<br>				created() &#123;<br><span class="javascript">					<span class="hljs-keyword">let</span> that = <span class="hljs-keyword">this</span></span><br><span class="actionscript">					mui.plusReady(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="actionscript">						<span class="hljs-comment">// 获取登录信息</span></span><br><span class="javascript">						that.user = <span class="hljs-built_in">JSON</span>.parse(plus.storage.getItem(<span class="hljs-string">'user'</span>))</span><br><span class="actionscript">						<span class="hljs-comment">// 获取接收人信息</span></span><br>						that.receiver = plus.webview.currentWebview().receiver<br><span class="actionscript">						<span class="hljs-comment">// 渲染最新消息数据</span></span><br><span class="actionscript">						that.messageData = that.receiver.messages != <span class="hljs-literal">undefined</span> ? that.receiver.messages : []</span><br><span class="actionscript">						<span class="hljs-comment">// 设置scroll</span></span><br><span class="actionscript">						mui(<span class="hljs-string">'.mui-scroll-wrapper'</span>).scroll(&#123;</span><br><span class="actionscript">							scrollY: <span class="hljs-literal">true</span>, <span class="hljs-comment">//是否竖向滚动</span></span><br><span class="actionscript">							scrollX: <span class="hljs-literal">false</span>, <span class="hljs-comment">//是否横向滚动</span></span><br><span class="actionscript">							startX: <span class="hljs-number">0</span>, <span class="hljs-comment">//初始化时滚动至x</span></span><br><span class="actionscript">							startY: <span class="hljs-number">0</span>, <span class="hljs-comment">//初始化时滚动至y</span></span><br><span class="actionscript">							indicators: <span class="hljs-literal">true</span>, <span class="hljs-comment">//是否显示滚动条</span></span><br><span class="actionscript">							deceleration: <span class="hljs-number">0.0005</span>, <span class="hljs-comment">//阻尼系数,系数越小滑动越灵敏</span></span><br><span class="actionscript">							bounce: <span class="hljs-literal">true</span> <span class="hljs-comment">//是否启用回弹</span></span><br>						&#125;)<br><span class="actionscript">						<span class="hljs-comment">//获取 message 页面</span></span><br><span class="actionscript">						<span class="hljs-keyword">var</span> wvs = plus.webview.all()</span><br><span class="actionscript">						<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, len = wvs.length; i &lt; len; i++) &#123;</span><br><span class="actionscript">							<span class="hljs-comment">// 获取建立socket连接的 message 页面</span></span><br><span class="actionscript">							<span class="hljs-keyword">if</span> (wvs[i].id == <span class="hljs-string">'message'</span>) &#123;</span><br><span class="actionscript">								<span class="hljs-comment">// 有socket连接的view</span></span><br>								vue.socketView = wvs[i]<br><span class="actionscript">								<span class="hljs-keyword">break</span></span><br>							&#125;<br>						&#125;<br>					&#125;)<br>				&#125;<br>			&#125;)<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>页面效果如下：</p>
</blockquote>
<p><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429143710209.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="尬友聊天页面"></p>
<blockquote>
<p> 这个页面的聊天气泡功能稍微有点复杂，可以参考项目中 chat_bubble.html 的页面的简化代码实现。另外，这个页面在发消息时需要调用 message 页面来发，因为只有 message 建立了 websocket 对象。调用其他页面的方法有两种方式，一种是  mui.fire() 方法，另一种是 evalJS()  方法。注意 <strong>evalJS() 方式只能传字符串参数，无法直接传对象，可以使用 JSON.stringify() 转为 json 串传参，被调用页面使用JSON.parse() 方法将 json 串转对象</strong>。</p>
</blockquote>
<h3 id="二维码页面（mine-qrcode-html）"><a href="#二维码页面（mine-qrcode-html）" class="headerlink" title="二维码页面（mine_qrcode.html）"></a>二维码页面（mine_qrcode.html）</h3><blockquote>
<p>前端代码：</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!doctype <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><br>	<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>二维码页面<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"css/mui.min.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span>&gt;</span><br><span class="css">			<span class="hljs-selector-class">.mui-bar-nav</span> &#123;</span><br><span class="css">				<span class="hljs-selector-tag">background-color</span>: <span class="hljs-selector-id">#4DB361</span>;</span><br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-qrcode-header</span> &#123;</span><br><span class="css">				<span class="hljs-selector-tag">color</span>: <span class="hljs-selector-id">#FFFFFF</span>;</span><br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-qrcode</span> &#123;</span><br>				margin: 30% 0 20% 0;<br>				text-align: center;<br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.qrcode_bg</span> &#123;</span><br>				width: 340px;<br>				height: 340px;<br>				background-image: url(img/qrcode_bg.png);<br>				background-size: cover;<br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.qrcode</span> &#123;</span><br>				padding-top: 50%;<br>			&#125;<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br>	<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><br>		<span class="hljs-tag">&lt;<span class="hljs-name">header</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-bar mui-bar-nav"</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-action-back mui-icon mui-icon-left-nav mui-pull-left galiao-qrcode-header"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-title galiao-qrcode-header"</span>&gt;</span>我的二维码<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span><br><br>		<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-content galiao-qrcode"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-card"</span>&gt;</span><br>				<span class="hljs-comment">&lt;!--页眉，放置标题--&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-card-header"</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">:src</span>=<span class="hljs-string">"user.userAvatar"</span> /&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">v-text</span>=<span class="hljs-string">"user.userNickname"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-card-content"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"padding: 10px;"</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"qrcode_bg"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"qrcode_bg"</span>&gt;</span><br>						<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"qrcode"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"qrcode"</span>&gt;</span><br>						<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>					<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/vue/2.6.11/vue.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js/qrcode.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js/mui.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><br>			mui.init()<br><br><br><span class="actionscript">			<span class="hljs-keyword">var</span> vue = <span class="hljs-keyword">new</span> Vue(&#123;</span><br><span class="actionscript">				el: <span class="hljs-string">'#app'</span>,</span><br>				data: &#123;<br>					user: &#123;&#125;<br>				&#125;,<br>				created() &#123;<br><span class="javascript">					<span class="hljs-keyword">let</span> that = <span class="hljs-keyword">this</span></span><br><span class="actionscript">					mui.plusReady(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="javascript">						that.user = <span class="hljs-built_in">JSON</span>.parse(plus.storage.getItem(<span class="hljs-string">'user'</span>))</span><br><span class="actionscript">						<span class="hljs-comment">// 设置参数方式</span></span><br><span class="actionscript">						<span class="hljs-keyword">var</span> qrcode = <span class="hljs-keyword">new</span> QRCode(<span class="hljs-string">'qrcode'</span>, &#123;</span><br><span class="actionscript">							text: that.user.userId + <span class="hljs-string">""</span>,</span><br>							width: 130,<br>							height: 130,<br><span class="actionscript">							colorDark: <span class="hljs-string">'#000000'</span>,</span><br><span class="actionscript">							colorLight: <span class="hljs-string">'#569362'</span>,</span><br>							correctLevel: QRCode.CorrectLevel.H<br>						&#125;);<br>					&#125;)<br>				&#125;<br>			&#125;)<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>页面效果:</p>
</blockquote>
<p><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429135658396.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="我的二维码页面"></p>
<blockquote>
<p>这个页面主要使用【<a href="http://davidshimjs.github.io/qrcodejs/" target="_blank" rel="noopener">qrcode.js</a>】对尬聊号生成二维码。</p>
</blockquote>
<h3 id="扫一扫页面（sao-html）"><a href="#扫一扫页面（sao-html）" class="headerlink" title="扫一扫页面（sao.html）"></a>扫一扫页面（sao.html）</h3><blockquote>
<p>前端代码：</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!doctype <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><br>	<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>扫一扫页面<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"css/mui.min.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span>&gt;</span><br><span class="css">			<span class="hljs-selector-class">.mui-bar-nav</span> &#123;</span><br><span class="css">				<span class="hljs-selector-tag">background-color</span>: <span class="hljs-selector-id">#4DB361</span>;</span><br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-sao-header</span> &#123;</span><br><span class="css">				<span class="hljs-selector-tag">color</span>: <span class="hljs-selector-id">#FFFFFF</span>;</span><br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.sao-qrcode</span> &#123;</span><br>				width: 350px;<br>				height: 350px;<br>				margin: 25% auto;<br>			&#125;<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br>	<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">header</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-bar mui-bar-nav"</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-action-back mui-icon mui-icon-left-nav mui-pull-left galiao-sao-header"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-title galiao-sao-header"</span>&gt;</span>扫一扫识别<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span><br><br>		<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-content"</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"saoQrcode"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"sao-qrcode"</span>&gt;</span><br>				<span class="hljs-comment">&lt;!--盛放扫描控件的div--&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js/mui.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><br>			mui.init()<br><br><span class="actionscript">			mui.plusReady(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="actionscript">				startRecognize(); <span class="hljs-comment">//开始扫描</span></span><br>			&#125;);<br><br><span class="actionscript">			<span class="hljs-comment">// 扫描组件</span></span><br><span class="actionscript">			<span class="hljs-keyword">var</span> scan;</span><br><br><span class="actionscript">			<span class="hljs-comment">//开启扫描方法</span></span><br><span class="actionscript">			<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">startRecognize</span><span class="hljs-params">()</span> </span>&#123;</span><br><span class="actionscript">				<span class="hljs-keyword">try</span> &#123;</span><br><span class="actionscript">					<span class="hljs-keyword">var</span> filter;</span><br><span class="actionscript">					<span class="hljs-comment">//自定义的扫描控件样式</span></span><br><span class="actionscript">					<span class="hljs-keyword">var</span> styles = &#123;</span><br><span class="actionscript">						frameColor: <span class="hljs-string">"#4DB361"</span>,</span><br><span class="actionscript">						scanbarColor: <span class="hljs-string">"#4DB361"</span>,</span><br><span class="actionscript">						background: <span class="hljs-string">""</span>,</span><br><span class="actionscript">						width: <span class="hljs-string">'80%'</span>,</span><br><span class="actionscript">						height: <span class="hljs-string">'80%'</span></span><br>					&#125;<br><span class="actionscript">					<span class="hljs-comment">//扫描控件构造</span></span><br><span class="actionscript">					scan = <span class="hljs-keyword">new</span> plus.barcode.Barcode(<span class="hljs-string">'saoQrcode'</span>, filter, styles);</span><br><span class="actionscript">					scan.onmarked = onmarked <span class="hljs-comment">// 扫描成功</span></span><br><span class="actionscript">					scan.onerror = onerror; <span class="hljs-comment">// 扫描错误</span></span><br>					scan.start();<br><span class="actionscript">				&#125; <span class="hljs-keyword">catch</span> (e) &#123;</span><br>					onerror(e)<br>				&#125;<br>			&#125;;<br><br><br><span class="actionscript">			<span class="hljs-comment">// 扫描成功回调 result是返回的结果</span></span><br><span class="actionscript">			<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onmarked</span><span class="hljs-params">(type, result, file)</span> </span>&#123;</span><br><span class="actionscript">				<span class="hljs-keyword">switch</span> (type) &#123;</span><br><span class="actionscript">					<span class="hljs-keyword">case</span> plus.barcode.QR:</span><br><span class="actionscript">						type = <span class="hljs-string">'QR'</span>;</span><br><span class="actionscript">						<span class="hljs-keyword">break</span>;</span><br><span class="actionscript">					<span class="hljs-keyword">default</span>:</span><br><span class="actionscript">						type = <span class="hljs-string">'其它'</span> + type;</span><br><span class="actionscript">						<span class="hljs-keyword">break</span>;</span><br>				&#125;<br><span class="actionscript">				<span class="hljs-comment">// 跳转页面</span></span><br>				mui.openWindow(&#123;<br><span class="actionscript">					url: <span class="hljs-string">'friend_info.html'</span>,</span><br><span class="actionscript">					id: <span class="hljs-string">'friend_info'</span>,</span><br>					extras: &#123;<br>						userId: result<br>					&#125;<br>				&#125;);<br><span class="actionscript">				setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>&#123;</span><br>					scan.start()<br>				&#125;, 1000)<br>			&#125;;<br><br><span class="actionscript">			<span class="hljs-comment">// 扫描失败回调 </span></span><br><span class="actionscript">			<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onerror</span><span class="hljs-params">(error)</span> </span>&#123;</span><br><span class="actionscript">				mui.alert(<span class="hljs-string">"扫描失败！"</span>)</span><br>				scan.start()<br>			&#125;;<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>页面效果：</p>
</blockquote>
<p><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429135658558.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="扫一扫页面"></p>
<blockquote>
<p>该页面主要使用  plus.barcode.Barcode  开启一个扫一扫的效果，设置回调函数。扫描成功就弹到好友信息页面，这个页面会发 ajax 去查好友信息。</p>
</blockquote>
<h3 id="搜索页面（sou-html）"><a href="#搜索页面（sou-html）" class="headerlink" title="搜索页面（sou.html）"></a>搜索页面（sou.html）</h3><blockquote>
<p>前端代码：</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!doctype <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><br>	<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>搜索页面<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"css/mui.min.css"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> /&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/css"</span>&gt;</span><br><span class="css">			<span class="hljs-selector-class">.mui-bar-nav</span> &#123;</span><br><span class="css">				<span class="hljs-selector-tag">background-color</span>: <span class="hljs-selector-id">#4DB361</span>;</span><br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-sou-header</span> &#123;</span><br><span class="css">				<span class="hljs-selector-tag">color</span>: <span class="hljs-selector-id">#FFFFFF</span>;</span><br>			&#125;<br><br><span class="css">			<span class="hljs-selector-class">.galiao-sou-search</span> &#123;</span><br>				margin: 10px 10px 0 10px;<br>			&#125;<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br>	<span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><br>		<span class="hljs-tag">&lt;<span class="hljs-name">header</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-bar mui-bar-nav"</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-action-back mui-icon mui-icon-left-nav mui-pull-left galiao-sou-header"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-title galiao-sou-header"</span>&gt;</span>搜索<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span><br><br>		<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-content"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"app"</span>&gt;</span><br>			<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-input-row mui-search galiao-sou-search"</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"search"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"searchValue"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-input-clear mui-input-speech"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"请输入尬聊号"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"search"</span>&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>			<span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">v-show</span>=<span class="hljs-string">"stranger.userId != null"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view"</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view-cell"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"btn_open_info"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"height: 60px; text-align: center;"</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"openInfo"</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-media-object mui-pull-left"</span> <span class="hljs-attr">:src</span>=<span class="hljs-string">"stranger.userAvatar"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"border-radius: 5px;"</span>&gt;</span><br>					<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-media-body mui-pull-left"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"padding-top: 10px;"</span> <span class="hljs-attr">v-text</span>=<span class="hljs-string">"stranger.userNickname"</span>&gt;</span><br>					<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>				<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br><br>			<span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">v-show</span>=<span class="hljs-string">"notFindUser"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view"</span>&gt;</span><br>				<span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mui-table-view-cell"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"height: 60px; text-align: center; padding-top: 20px;"</span>&gt;</span><br>					用户不存在<br>				<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br>			<span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span><br><br>			<span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"galiao-sou-search"</span>&gt;</span>注：输入好友的尬聊号搜索添加好友。尬聊号可以在 ‘我的’ <span class="hljs-symbol">&amp;nbsp;</span> -&gt; <span class="hljs-symbol">&amp;nbsp;</span>‘尬聊号’ 处查看。<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>		<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js/config.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/vue/2.6.11/vue.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://cdn.bootcss.com/axios/0.19.2/axios.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"js/mui.min.js"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>		<span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text/javascript"</span>&gt;</span><br>			mui.init()<br><br><span class="actionscript">			<span class="hljs-comment">// 点击开始搜索</span></span><br><span class="javascript">			mui(<span class="hljs-built_in">document</span>.body).on(<span class="hljs-string">'keypress'</span>, <span class="hljs-string">'#searchValue'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="actionscript">				<span class="hljs-keyword">this</span>.click();</span><br>			&#125;)<br>			<br><span class="actionscript">			<span class="hljs-comment">// 点击打开详情</span></span><br><span class="javascript">			mui(<span class="hljs-built_in">document</span>.body).on(<span class="hljs-string">'tap'</span>, <span class="hljs-string">'#btn_open_info'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>&#123;</span><br><span class="actionscript">				<span class="hljs-keyword">this</span>.click();</span><br>			&#125;)<br><br><span class="actionscript">			<span class="hljs-comment">// vue实例</span></span><br><span class="actionscript">			<span class="hljs-keyword">var</span> vue = <span class="hljs-keyword">new</span> Vue(&#123;</span><br><span class="actionscript">				el: <span class="hljs-string">'#app'</span>,</span><br>				data: &#123;<br><span class="actionscript">					notFindUser: <span class="hljs-literal">false</span>,</span><br>					stranger: &#123;<br><span class="actionscript">						userId: <span class="hljs-literal">null</span>,</span><br><span class="actionscript">						userAvatar: <span class="hljs-string">''</span>,</span><br><span class="actionscript">						userNickname: <span class="hljs-string">''</span></span><br>					&#125;<br>				&#125;,<br>				methods: &#123;<br><span class="actionscript">					<span class="hljs-comment">// 搜索</span></span><br>					search() &#123;<br><span class="javascript">						<span class="hljs-keyword">let</span> that = <span class="hljs-keyword">this</span></span><br><span class="actionscript">						that.notFindUser = <span class="hljs-literal">false</span></span><br><span class="javascript">						<span class="hljs-keyword">let</span> searchValue = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'searchValue'</span>).value</span><br><span class="actionscript">						<span class="hljs-keyword">if</span>(searchValue === <span class="hljs-string">''</span>) <span class="hljs-keyword">return</span> </span><br><span class="actionscript">						axios.get(config.app.baseUrl + <span class="hljs-string">'/user/search/'</span> + searchValue, &#123;</span><br>								params: &#123;<br><span class="javascript">									token: <span class="hljs-built_in">JSON</span>.parse(plus.storage.getItem(<span class="hljs-string">'user'</span>)).token</span><br>								&#125;<br>							&#125;)<br><span class="actionscript">							.then(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(res)</span> </span>&#123;</span><br><span class="actionscript">								<span class="hljs-keyword">var</span> data = res.data</span><br>								if (data.code == 3) &#123;<br>									that.stranger = &#123;<br><span class="actionscript">										userId: <span class="hljs-literal">null</span>,</span><br><span class="actionscript">										userAvatar: <span class="hljs-string">''</span>,</span><br><span class="actionscript">										userNickname: <span class="hljs-string">''</span></span><br>									&#125;<br><span class="actionscript">									that.notFindUser = <span class="hljs-literal">true</span></span><br><span class="actionscript">									<span class="hljs-keyword">return</span></span><br>								&#125;<br>								if (data.code != 1) &#123;<br>									mui.alert(data.data)<br><span class="actionscript">									<span class="hljs-keyword">return</span></span><br>								&#125;<br>								that.stranger = data.data<br>							&#125;)<br><span class="actionscript">							.catch(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(error)</span> </span>&#123;</span><br><span class="javascript">								<span class="hljs-built_in">console</span>.log(error)</span><br>							&#125;);<br>					&#125;,<br><span class="actionscript">					<span class="hljs-comment">// 打开详情页</span></span><br>					openInfo() &#123;<br>						mui.openWindow(&#123;<br><span class="actionscript">							url: <span class="hljs-string">'friend_info.html'</span>,</span><br><span class="actionscript">							id: <span class="hljs-string">'friend_info'</span>,</span><br>							extras: &#123;<br><span class="actionscript">								userId: <span class="hljs-keyword">this</span>.stranger.userId</span><br>							&#125;<br>						&#125;);<br>					&#125;<br>				&#125;,<br>				created() &#123;<br><span class="actionscript">					mui.plusReady(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>&#123;</span><br><br>					&#125;);<br>				&#125;<br>			&#125;)<br>		<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>	<span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>页面效果:</p>
</blockquote>
<p><img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429135658311.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQxNzkzMzk0,size_16,color_FFFFFF,t_70" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="搜索页面"></p>
<blockquote>
<p>这个页面难点在于输入框的回车事件的监听，如果是 vue  的 @keyup.enter.native 就监听不到，需要使用 mui 监听 keypress 事件。输入框 添加  mui-input-speech 的 class ，mui 实现了语音输入。</p>
</blockquote>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><blockquote>
<p> 至于其他页面功能稍微简单一些，可以去项目里面克隆源代码交流。【<a href="https://gitee.com/junanaa/galiao-mui" target="_blank" rel="noopener">尬聊前端源码</a>】、【<a href="https://gitee.com/junanaa/galiao-java" target="_blank" rel="noopener">尬聊后端源码</a>】</p>
</blockquote>
<h2 id="展望"><a href="#展望" class="headerlink" title="展望"></a>展望</h2><blockquote>
<p> 虽然开发了一些功能，但是还有很多问题需要去发现和解决。比如消息无法保存等 问题。</p>
</blockquote>
<blockquote>
<p> 后边我希望增加有趣的功能，比如过滤 不良消息词汇，用美好的词代替，净化网络暴力。比如 ： 你是傻逼  代替为  你是靓仔。让我们的交流更加美好。</p>
</blockquote>
<blockquote>
<p>当然了，如果你想到了有趣的功能欢迎留言（说不定哪天就去实现了）。要是愿意参与到开源项目的开发当然更好了。走过路过，留个 star 呗。</p>
</blockquote>
<blockquote>
<p> 博客地址：<a href="https://www.anlazy.top/index.php/archives/308/" target="_blank" rel="noopener">https://www.anlazy.top/index.php/archives/308/</a><br> 本人公众号：一只小安仔<br> <img   class="lazyload" data-original="https://img-blog.csdnimg.cn/20200429173826572.jpg" src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg=="  alt="公众号"></p>
</blockquote>

    </section>
    <section class="extra">
      
      
  <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/mui/" rel="tag">mui</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%89%8D%E7%AB%AF/" rel="tag">前端</a></li></ul>

      
<nav class="nav">
  
    <a href="/2020/05/07/13%20%E7%BD%91%E6%98%93%E4%BA%91%E9%9F%B3%E4%B9%90%E5%85%8D%E8%B4%B9%E4%B8%8B%E8%BD%BD%EF%BC%88%E5%AE%9E%E7%8E%B0%E6%80%9D%E8%B7%AF%E5%92%8C%E7%BB%86%E8%8A%82%EF%BC%89/"><i class="iconfont iconleft"></i>网易云音乐免费下载（实现思路和细节）</a>
  
  
    <a href="/2020/05/05/6%20%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E7%9A%84%E6%95%B0%E7%BB%84%E8%BD%AC%E9%9B%86%E5%90%88/">如何优雅的数组转集合<i class="iconfont iconright"></i></a>
  
</nav>

    </section>
    
      <section class="comments">
        
          <div class="btn" id="comments-btn">查看评论</div>
        
        
<div id="valine"></div>
<script defer src="//unpkg.com/valine/dist/Valine.min.js"></script>
<script>
  window.onload = function () {
    var loadValine = function () {
      new Valine({
        el: '#valine',
        app_id: "a8aBoMUoOnc1VQB8luHmCH4Y-gzGzoHsz",
        app_key: "EEUcoQEF0g8aC9y8tqj1koxE",
        placeholder: "大爷来玩呀~",
        avatar: "mp",
        pageSize: "10",
        lang: "zh-CN",
      });
    }
    if ( true ) {
      $("#comments-btn").on("click", function () {
        $(this).hide();
        loadValine();
      });
    } else {
      loadValine();
    }
  };
</script>

      </section>
    
  </section>
</article>
  </div>
</main>
  <footer class="footer">
  <div class="footer-social">
    
    
    
    
    
    <a href="tencent://message/?Menu=yes&uin=1286890175 " target="_blank" onMouseOver="this.style.color= '#12B7F5'"
      onMouseOut="this.style.color='#33333D'">
      <i class="iconfont footer-social-item  iconQQ "></i>
    </a>
    
    
    
    
    
    <a href="javascript:; " target="_blank" onMouseOver="this.style.color= '#09BB07'"
      onMouseOut="this.style.color='#33333D'">
      <i class="iconfont footer-social-item  iconwechat-fill "></i>
    </a>
    
    
    
    
    
    <a href="mailto:chenjunan_2018@163.com " target="_blank" onMouseOver="this.style.color='#FFBE5B'"
      onMouseOut="this.style.color='#33333D'">
      <i class="iconfont footer-social-item  iconmail"></i>
    </a>
    
  </div>
  <div class="footer-copyright"><p>Copyright© 2019-2020 | <a target="_blank" href="http://junanaa.gitee.io/">一只小安仔</a> .AllRightsReserved</p></div>
</footer>
  
      <div class="fab fab-plus">
    <i class="iconfont iconplus"></i>
  </div>
  <div class="fab fab-up">
    <i class="iconfont iconcaret-up"></i>
  </div>
  <div class="fab fab-menu">
    <i class="iconfont iconmenu"></i>
  </div>
  
</body>


<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>






<script src="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.js"></script>








<script src="https://cdn.bootcdn.net/ajax/libs/jquery.lazyload/1.9.1/jquery.lazyload.min.js"></script>






<script src="https://cdn.bootcdn.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js"></script>






<script src="/js/script.js"></script>



<script>
  (function () {
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    } else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
  })();
</script>











</html>